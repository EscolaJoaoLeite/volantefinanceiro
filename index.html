<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Volante Financeiro</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }
        .logo-animation {
            animation: rotate 3s linear infinite;
        }
        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- Tela de Login -->
    <div id="loginScreen" class="min-h-screen gradient-bg flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl p-8 w-full max-w-md fade-in">
            <!-- Logo -->
            <div class="text-center mb-8">
                <div class="inline-block relative">
                    <div class="w-20 h-20 mx-auto mb-4 bg-green-600 rounded-full flex items-center justify-center logo-animation">
                        <svg class="w-12 h-12 text-white" viewBox="0 0 24 24" fill="currentColor">
                            <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" fill="none"/>
                            <circle cx="12" cy="12" r="6" stroke="currentColor" stroke-width="1" fill="none"/>
                            <text x="12" y="16" text-anchor="middle" class="text-xs font-bold fill-current">$</text>
                        </svg>
                    </div>
                </div>
                <h1 class="text-2xl font-bold text-green-800 mb-2">Volante Financeiro</h1>
                <p class="text-sm text-gray-600">Desenvolvido por Escola Estadual Dr. João Leite de Barros</p>
            </div>

            <!-- Formulário de Login -->
            <form id="loginForm" class="space-y-6">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">CPF</label>
                    <input type="text" id="loginCpf" placeholder="000.000.000-00" 
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all duration-300">
                    <div id="cpfValidationMessage" class="mt-1 text-sm hidden"></div>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Senha</label>
                    <input type="password" id="loginPassword" placeholder="Digite sua senha"
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent">
                </div>
                
                <div class="flex items-center mb-4">
                    <input type="checkbox" id="rememberLogin" class="mr-2 rounded">
                    <label for="rememberLogin" class="text-sm text-gray-600">Lembrar meus dados</label>
                </div>
                
                <button type="submit" class="w-full bg-green-600 text-white py-3 rounded-lg font-semibold hover:bg-green-700 transition duration-200">
                    Entrar
                </button>
            </form>

            <div class="mt-6 space-y-3">
                <button onclick="showRegister()" class="w-full bg-gray-100 text-green-700 py-3 rounded-lg font-semibold hover:bg-gray-200 transition duration-200">
                    Cadastrar Nova Conta
                </button>
                <button onclick="showPasswordReset()" class="w-full text-green-600 hover:text-green-800 text-sm">
                    Esqueci minha senha
                </button>
                <div class="relative my-4">
                    <div class="absolute inset-0 flex items-center">
                        <div class="w-full border-t border-gray-300"></div>
                    </div>
                    <div class="relative flex justify-center text-sm">
                        <span class="px-2 bg-white text-gray-500">ou</span>
                    </div>
                </div>
                
                <button onclick="handleTestLogin()" class="w-full bg-purple-600 text-white py-3 rounded-lg font-semibold hover:bg-purple-700 transition duration-200 flex items-center justify-center space-x-2">
                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                    </svg>
                    <span>Teste Grátis (7 dias)</span>
                </button>
                
                <button onclick="showAdminLogin()" class="w-full text-gray-500 hover:text-gray-700 text-xs">
                    Acesso Administrador
                </button>
            </div>
        </div>
    </div>

    <!-- Tela de Cadastro -->
    <div id="registerScreen" class="hidden min-h-screen gradient-bg flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl p-8 w-full max-w-md fade-in">
            <div class="text-center mb-6">
                <h2 class="text-2xl font-bold text-green-800">Novo Cadastro</h2>
                <p class="text-gray-600">Preencha seus dados</p>
            </div>

            <form id="registerForm" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Nome Completo</label>
                    <input type="text" id="regName" required
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">CPF</label>
                    <input type="text" id="regCpf" placeholder="000.000.000-00" required
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Idade</label>
                    <input type="number" id="regAge" min="18" max="80" required
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Email</label>
                    <input type="email" id="regEmail" required
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">WhatsApp</label>
                    <input type="tel" id="regWhatsapp" placeholder="(67) 99999-9999" required
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Senha</label>
                    <input type="password" id="regPassword" required
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Plataforma Principal</label>
                    <select id="regPlatform" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500">
                        <option value="">Selecione...</option>
                        <option value="BR Car">BR Car</option>
                        <option value="IBolt">IBolt</option>
                        <option value="Ifood">Ifood</option>
                        <option value="InDriver">InDriver</option>
                        <option value="Uber">Uber</option>
                        <option value="Tô Aqui">Tô Aqui</option>
                        <option value="Taxi-Connect">Taxi-Connect</option>
                        <option value="Urban">Urban</option>
                        <option value="Outros">Outros</option>
                    </select>
                </div>

                <button type="submit" class="w-full bg-green-600 text-white py-3 rounded-lg font-semibold hover:bg-green-700">
                    Cadastrar
                </button>
            </form>

            <button onclick="showLogin()" class="w-full mt-4 text-green-600 hover:text-green-800">
                Voltar ao Login
            </button>
        </div>
    </div>

    <!-- Tela de Recuperação de Senha -->
    <div id="passwordResetScreen" class="hidden min-h-screen gradient-bg flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl p-8 w-full max-w-md fade-in">
            <div class="text-center mb-6">
                <h2 class="text-2xl font-bold text-green-800">Recuperar Senha</h2>
                <p class="text-gray-600">Digite seu email cadastrado</p>
            </div>

            <form id="resetForm" class="space-y-6">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Email</label>
                    <input type="email" id="resetEmail" required
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500">
                </div>
                
                <button type="submit" class="w-full bg-green-600 text-white py-3 rounded-lg font-semibold hover:bg-green-700">
                    Enviar Nova Senha
                </button>
            </form>

            <button onclick="showLogin()" class="w-full mt-4 text-green-600 hover:text-green-800">
                Voltar ao Login
            </button>
        </div>
    </div>

    <!-- Login Administrador -->
    <div id="adminLoginScreen" class="hidden min-h-screen gradient-bg flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl p-8 w-full max-w-md fade-in">
            <div class="text-center mb-6">
                <h2 class="text-2xl font-bold text-red-600">Acesso Administrador</h2>
                <p class="text-gray-600">Área restrita</p>
            </div>

            <form id="adminLoginForm" class="space-y-6">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Usuário</label>
                    <input type="text" id="adminUser" value="desenvolvedor" readonly
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg bg-gray-100">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Senha</label>
                    <input type="password" id="adminPassword" placeholder="Digite a senha de administrador"
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500">
                </div>
                
                <button type="submit" class="w-full bg-red-600 text-white py-3 rounded-lg font-semibold hover:bg-red-700">
                    Entrar como Admin
                </button>
            </form>

            <button onclick="showLogin()" class="w-full mt-4 text-green-600 hover:text-green-800">
                Voltar ao Login
            </button>
        </div>
    </div>

    <!-- Dashboard Principal -->
    <div id="dashboardScreen" class="hidden min-h-screen bg-gray-50 flex flex-col">
        <!-- Header -->
        <header class="bg-white shadow-sm border-b">
            <div class="px-4 py-4 flex justify-between items-center">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-green-600 rounded-full flex items-center justify-center" id="appLogoDisplay">
                        <span class="text-white font-bold">$</span>
                    </div>
                    <div>
                        <h1 class="font-bold text-green-800">Volante Financeiro</h1>
                        <p class="text-xs text-gray-500" id="userWelcome">Bem-vindo!</p>
                    </div>
                </div>
                <button onclick="logout()" class="text-red-600 hover:text-red-800 text-sm">
                    Sair
                </button>
            </div>
        </header>

        <!-- Navegação -->
        <nav class="bg-white border-b">
            <div class="flex overflow-x-auto">
                <button onclick="showTab('earnings')" class="tab-btn px-6 py-3 text-sm font-medium border-b-2 border-green-600 text-green-600">
                    Ganhos
                </button>
                <button onclick="showTab('expenses')" class="tab-btn px-6 py-3 text-sm font-medium text-gray-500 hover:text-green-600">
                    Despesas
                </button>
                <button onclick="showTab('savings')" class="tab-btn px-6 py-3 text-sm font-medium text-gray-500 hover:text-green-600">
                    Cofres
                </button>
                <button onclick="showTab('analytics')" class="tab-btn px-6 py-3 text-sm font-medium text-gray-500 hover:text-green-600">
                    Análises
                </button>
                <button onclick="showTab('goals')" class="tab-btn px-6 py-3 text-sm font-medium text-gray-500 hover:text-green-600">
                    Metas
                </button>
                <button onclick="showTab('supporters')" class="tab-btn px-6 py-3 text-sm font-medium text-gray-500 hover:text-green-600">
                    Apoiadores
                </button>
                <button onclick="showTab('about')" class="tab-btn px-6 py-3 text-sm font-medium text-gray-500 hover:text-green-600">
                    Sobre
                </button>
            </div>
        </nav>

        <!-- Conteúdo das Abas -->
        <div class="p-4">
            <!-- Aba Ganhos -->
            <div id="earningsTab" class="tab-content">
                <div class="bg-white rounded-lg shadow p-6 mb-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-4">Registrar Ganho</h2>
                    <form id="earningsForm" class="space-y-4">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Plataforma</label>
                                <select id="earningPlatform" class="w-full px-3 py-2 border rounded-lg">
                                    <option value="BR Car">BR Car</option>
                                    <option value="IBolt">IBolt</option>
                                    <option value="Ifood">Ifood</option>
                                    <option value="InDriver">InDriver</option>
                                    <option value="Uber">Uber</option>
                                    <option value="Tô Aqui">Tô Aqui</option>
                                    <option value="Taxi-Connect">Taxi-Connect</option>
                                    <option value="Urban">Urban</option>
                                    <option value="Outros">Outros</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Valor (R$)</label>
                                <input type="number" id="earningAmount" step="0.01" min="0" 
                                       class="w-full px-3 py-2 border rounded-lg">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Data</label>
                                <input type="date" id="earningDate" 
                                       class="w-full px-3 py-2 border rounded-lg">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Tipo</label>
                                <select id="earningType" class="w-full px-3 py-2 border rounded-lg">
                                    <option value="Corrida">Corrida</option>
                                    <option value="Entrega">Entrega</option>
                                    <option value="Gorjeta">Gorjeta</option>
                                </select>
                            </div>
                        </div>
                        <button type="submit" class="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700">
                            Adicionar Ganho
                        </button>
                    </form>
                </div>

                <!-- Lista de Ganhos -->
                <div class="bg-white rounded-lg shadow p-6">
                    <h3 class="text-lg font-semibold mb-4">Ganhos Recentes</h3>
                    <div id="earningsList" class="space-y-3">
                        <!-- Ganhos serão listados aqui -->
                    </div>
                </div>
            </div>

            <!-- Aba Despesas -->
            <div id="expensesTab" class="tab-content hidden">
                <div class="bg-white rounded-lg shadow p-6 mb-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-4">Registrar Despesa</h2>
                    <form id="expensesForm" class="space-y-4">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Categoria</label>
                                <select id="expenseCategory" class="w-full px-3 py-2 border rounded-lg">
                                    <option value="Combustível">Combustível</option>
                                    <option value="Manutenção">Manutenção</option>
                                    <option value="Documentação">Documentação</option>
                                    <option value="Alimentação">Alimentação</option>
                                    <option value="Seguro">Seguro</option>
                                    <option value="IPVA">IPVA</option>
                                    <option value="Licenciamento">Licenciamento</option>
                                    <option value="Multas">Multas</option>
                                    <option value="Estacionamento">Estacionamento</option>
                                    <option value="Lavagem">Lavagem do Veículo</option>
                                    <option value="Pneus">Pneus</option>
                                    <option value="Óleo">Óleo e Filtros</option>
                                    <option value="Peças">Peças e Acessórios</option>
                                    <option value="Telefone">Telefone/Internet</option>
                                    <option value="Outros">Outros</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Valor (R$)</label>
                                <input type="number" id="expenseAmount" step="0.01" min="0" 
                                       class="w-full px-3 py-2 border rounded-lg">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Data</label>
                                <input type="date" id="expenseDate" 
                                       class="w-full px-3 py-2 border rounded-lg">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Descrição</label>
                                <input type="text" id="expenseDescription" placeholder="Descrição opcional"
                                       class="w-full px-3 py-2 border rounded-lg">
                            </div>
                        </div>
                        <button type="submit" class="bg-red-600 text-white px-6 py-2 rounded-lg hover:bg-red-700">
                            Adicionar Despesa
                        </button>
                    </form>
                </div>

                <!-- Lista de Despesas -->
                <div class="bg-white rounded-lg shadow p-6">
                    <h3 class="text-lg font-semibold mb-4">Despesas Recentes</h3>
                    <div id="expensesList" class="space-y-3">
                        <!-- Despesas serão listadas aqui -->
                    </div>
                </div>
            </div>

            <!-- Aba Cofres -->
            <div id="savingsTab" class="tab-content hidden">
                <div class="bg-white rounded-lg shadow p-6 mb-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-4">💰 Separar Dinheiro no Cofre</h2>
                    <form id="savingsForm" class="space-y-4">
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Valor (R$)</label>
                                <input type="number" id="savingAmount" step="0.01" min="0" 
                                       class="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Finalidade do Cofre</label>
                                <select id="savingPurpose" class="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500">
                                    <option value="Emergência">🚨 Emergência</option>
                                    <option value="Manutenção">🔧 Manutenção Futura</option>
                                    <option value="Investimento">📈 Investimento</option>
                                    <option value="IPVA">🚗 IPVA</option>
                                    <option value="Seguro">🛡️ Seguro</option>
                                    <option value="Férias">🏖️ Férias</option>
                                    <option value="Outros">💼 Outros</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Meta (R$) - Opcional</label>
                                <input type="number" id="savingGoal" step="0.01" min="0" placeholder="Ex: 5000.00"
                                       class="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500">
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Observações</label>
                            <input type="text" id="savingNotes" placeholder="Ex: Para troca de pneus em dezembro"
                                   class="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500">
                        </div>
                        <button type="submit" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 font-semibold">
                            💰 Guardar no Cofre
                        </button>
                    </form>
                </div>

                <!-- Resumo de Cofres -->
                <div class="bg-white rounded-lg shadow p-6 mb-6">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-lg font-semibold">💰 Meus Cofres</h3>
                        <div class="text-right">
                            <p class="text-sm text-gray-600">Total Guardado</p>
                            <p class="text-2xl font-bold text-blue-600" id="totalSavingsAmount">R$ 0,00</p>
                        </div>
                    </div>
                    <div id="savingsSummary" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                        <!-- Resumo dos cofres -->
                    </div>
                </div>

                <!-- Histórico de Movimentações -->
                <div class="bg-white rounded-lg shadow p-6">
                    <h3 class="text-lg font-semibold mb-4">📋 Histórico de Movimentações</h3>
                    <div id="savingsHistory" class="space-y-3">
                        <!-- Histórico será listado aqui -->
                    </div>
                </div>
            </div>

            <!-- Aba Metas -->
            <div id="goalsTab" class="tab-content hidden">
                <div class="bg-white rounded-lg shadow p-6 mb-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-4">🎯 Definir Nova Meta</h2>
                    <form id="goalsForm" class="space-y-4">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Nome da Meta</label>
                                <input type="text" id="goalName" placeholder="Ex: Comprar carro novo" required
                                       class="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Valor da Meta (R$)</label>
                                <input type="number" id="goalAmount" step="0.01" min="0" required
                                       class="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Data Limite</label>
                                <input type="date" id="goalDate" required
                                       class="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Categoria</label>
                                <select id="goalCategory" class="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500">
                                    <option value="Veículo">🚗 Veículo</option>
                                    <option value="Casa">🏠 Casa</option>
                                    <option value="Viagem">✈️ Viagem</option>
                                    <option value="Educação">📚 Educação</option>
                                    <option value="Saúde">🏥 Saúde</option>
                                    <option value="Negócio">💼 Negócio</option>
                                    <option value="Outros">🎯 Outros</option>
                                </select>
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Descrição</label>
                            <textarea id="goalDescription" rows="2" placeholder="Descreva sua meta..."
                                      class="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500"></textarea>
                        </div>
                        <button type="submit" class="bg-purple-600 text-white px-6 py-2 rounded-lg hover:bg-purple-700 font-semibold">
                            🎯 Criar Meta
                        </button>
                    </form>
                </div>

                <!-- Lista de Metas -->
                <div class="bg-white rounded-lg shadow p-6">
                    <h3 class="text-lg font-semibold mb-4">📊 Minhas Metas</h3>
                    <div id="goalsList" class="space-y-4">
                        <!-- Metas serão listadas aqui -->
                    </div>
                </div>
            </div>

            <!-- Aba Apoiadores -->
            <div id="supportersTab" class="tab-content hidden">
                <div class="bg-white rounded-lg shadow p-6 mb-6">
                    <div class="text-center mb-8">
                        <h2 class="text-2xl font-bold text-green-800 mb-4">Nossos Apoiadores</h2>
                        <p class="text-gray-600">Empresas e organizações que apoiam o desenvolvimento do Volante Financeiro</p>
                    </div>

                    <div id="supportersList" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <!-- Apoiadores serão carregados aqui -->
                    </div>

                    <div class="text-center mt-8 p-6 bg-green-50 rounded-lg">
                        <h3 class="text-lg font-semibold text-green-800 mb-2">Quer apoiar nosso projeto?</h3>
                        <p class="text-gray-600 mb-4">Entre em contato conosco para saber como sua empresa pode apoiar o Volante Financeiro</p>
                        <div class="flex flex-wrap justify-center gap-3">
                            <button onclick="contactSupportWhatsApp()" class="bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 font-semibold flex items-center space-x-2">
                                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.885 3.488"/>
                                </svg>
                                <span>WhatsApp</span>
                            </button>
                            <button onclick="contactSupportEmail()" class="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 font-semibold flex items-center space-x-2">
                                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M24 5.457v13.909c0 .904-.732 1.636-1.636 1.636h-3.819V11.73L12 16.64l-6.545-4.91v9.273H1.636A1.636 1.636 0 0 1 0 19.366V5.457c0-.904.732-1.636 1.636-1.636h3.819v.273L12 10.186l6.545-6.092v-.273h3.819c.904 0 1.636.732 1.636 1.636z"/>
                                </svg>
                                <span>Email</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Aba Análises -->
            <div id="analyticsTab" class="tab-content hidden">
                <!-- Seletor de Período -->
                <div class="bg-white rounded-lg shadow p-4 mb-6">
                    <div class="flex flex-wrap items-center justify-between gap-4">
                        <h2 class="text-xl font-bold text-gray-800">📊 Análises Financeiras</h2>
                        <div class="flex items-center space-x-4">
                            <label class="text-sm font-medium text-gray-700">Período:</label>
                            <select id="analyticsPeriod" onchange="updateAnalyticsPeriod()" class="px-3 py-2 border rounded-lg focus:ring-2 focus:ring-green-500">
                                <option value="daily">📅 Diário</option>
                                <option value="weekly">📊 Semanal</option>
                                <option value="monthly" selected>📈 Mensal</option>
                                <option value="yearly">🗓️ Anual</option>
                            </select>
                            <input type="month" id="analyticsMonth" onchange="updateAnalyticsPeriod()" 
                                   class="px-3 py-2 border rounded-lg focus:ring-2 focus:ring-green-500">
                        </div>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                    <div class="bg-white rounded-lg shadow p-6">
                        <h3 class="text-lg font-semibold mb-4" id="summaryTitle">Resumo Mensal</h3>
                        <div class="space-y-3">
                            <div class="flex justify-between">
                                <span class="text-gray-600">Total Ganhos:</span>
                                <span class="font-semibold text-green-600" id="totalEarnings">R$ 0,00</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Total Despesas:</span>
                                <span class="font-semibold text-red-600" id="totalExpenses">R$ 0,00</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Total Reservas:</span>
                                <span class="font-semibold text-blue-600" id="totalSavings">R$ 0,00</span>
                            </div>
                            <hr>
                            <div class="flex justify-between text-lg">
                                <span class="font-semibold">Lucro Líquido:</span>
                                <span class="font-bold" id="netProfit">R$ 0,00</span>
                            </div>
                        </div>
                    </div>

                    <div class="bg-white rounded-lg shadow p-6">
                        <h3 class="text-lg font-semibold mb-4">Gráfico Mensal</h3>
                        <div class="relative h-64">
                            <canvas id="monthlyChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Aba Sobre -->
            <div id="aboutTab" class="tab-content hidden">
                <div class="bg-white rounded-lg shadow p-6">
                    <div class="text-center mb-8">
                        <div class="w-20 h-20 mx-auto mb-4 bg-green-600 rounded-full flex items-center justify-center">
                            <span class="text-white font-bold text-2xl">$</span>
                        </div>
                        <h2 class="text-2xl font-bold text-green-800 mb-2">Volante Financeiro</h2>
                        <p class="text-gray-600">Sistema de Gestão Financeira para Motoristas</p>
                    </div>

                    <div class="space-y-6">
                        <div>
                            <h3 class="text-lg font-semibold text-gray-800 mb-3">Sobre o Projeto</h3>
                            <p class="text-gray-600 leading-relaxed">
                                O Volante Financeiro é um aplicativo desenvolvido especialmente para motoristas de aplicativo 
                                e profissionais do transporte em Corumbá-MS e Ladário-MS. O sistema permite organizar despesas 
                                pessoais e operacionais, planejar ganhos, monitorar custos e otimizar a rentabilidade, 
                                adaptando-se à realidade local da região.
                            </p>
                        </div>

                        <div>
                            <h3 class="text-lg font-semibold text-gray-800 mb-3">Desenvolvedores</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div class="bg-gray-50 p-4 rounded-lg">
                                    <h4 class="font-semibold text-green-700 mb-2">Equipe de Desenvolvimento</h4>
                                    <ul class="text-sm text-gray-600 space-y-1">
                                        <li>• João Victor Ribeiro de Souza</li>
                                        <li>• Odilon Chalis</li>
                                        <li>• Thaviny Maria Moraes de Toledo Soares</li>
                                        <li>• Wallace Kauã Samosa Coronel</li>
                                    </ul>
                                </div>
                                <div class="bg-gray-50 p-4 rounded-lg">
                                    <h4 class="font-semibold text-green-700 mb-2">Professores Responsáveis</h4>
                                    <ul class="text-sm text-gray-600 space-y-1">
                                        <li>• Gabriela Luiza da Costa Neves</li>
                                        <li>• Wellington Cesar de Oliveira</li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <div>
                            <h3 class="text-lg font-semibold text-gray-800 mb-3">Funcionalidades</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <ul class="text-sm text-gray-600 space-y-2">
                                    <li class="flex items-center">
                                        <span class="w-2 h-2 bg-green-500 rounded-full mr-3"></span>
                                        Controle de ganhos por corrida/entrega
                                    </li>
                                    <li class="flex items-center">
                                        <span class="w-2 h-2 bg-green-500 rounded-full mr-3"></span>
                                        Gestão de despesas operacionais
                                    </li>
                                    <li class="flex items-center">
                                        <span class="w-2 h-2 bg-green-500 rounded-full mr-3"></span>
                                        Sistema de reservas financeiras
                                    </li>
                                    <li class="flex items-center">
                                        <span class="w-2 h-2 bg-green-500 rounded-full mr-3"></span>
                                        Análises e relatórios detalhados
                                    </li>
                                </ul>
                                <ul class="text-sm text-gray-600 space-y-2">
                                    <li class="flex items-center">
                                        <span class="w-2 h-2 bg-green-500 rounded-full mr-3"></span>
                                        Suporte a múltiplas plataformas
                                    </li>
                                    <li class="flex items-center">
                                        <span class="w-2 h-2 bg-green-500 rounded-full mr-3"></span>
                                        Interface responsiva e intuitiva
                                    </li>
                                    <li class="flex items-center">
                                        <span class="w-2 h-2 bg-green-500 rounded-full mr-3"></span>
                                        Painel administrativo completo
                                    </li>
                                    <li class="flex items-center">
                                        <span class="w-2 h-2 bg-green-500 rounded-full mr-3"></span>
                                        Notificações via WhatsApp
                                    </li>
                                </ul>
                            </div>
                        </div>

                        <div class="text-center pt-6 border-t">
                            <p class="text-sm text-gray-500">
                                Versão 1.0 - 2024 | Desenvolvido com ❤️ para a comunidade de motoristas
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Rodapé -->
        <footer class="mt-auto bg-green-800 text-white py-3">
            <div class="text-center">
                <p class="text-sm">Desenvolvido por <strong>Escola Estadual Dr. João Leite de Barros</strong></p>
            </div>
        </footer>
    </div>

    <!-- Painel Administrador -->
    <div id="adminDashboard" class="hidden min-h-screen bg-gray-50">
        <!-- Header Admin -->
        <header class="bg-red-600 text-white shadow-sm">
            <div class="px-4 py-4 flex justify-between items-center">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-white rounded-full flex items-center justify-center">
                        <span class="text-red-600 font-bold">A</span>
                    </div>
                    <div>
                        <h1 class="font-bold">Painel Administrador</h1>
                        <p class="text-xs opacity-75">Volante Financeiro</p>
                    </div>
                </div>
                <button onclick="logout()" class="bg-red-700 px-4 py-2 rounded hover:bg-red-800">
                    Sair
                </button>
            </div>
        </header>

        <!-- Navegação Admin -->
        <nav class="bg-white border-b">
            <div class="flex overflow-x-auto">
                <button onclick="showAdminTab('users')" class="admin-tab-btn px-6 py-3 text-sm font-medium border-b-2 border-red-600 text-red-600">
                    Usuários
                </button>
                <button onclick="showAdminTab('settings')" class="admin-tab-btn px-6 py-3 text-sm font-medium text-gray-500 hover:text-red-600">
                    Configurações
                </button>
                <button onclick="showAdminTab('supporters')" class="admin-tab-btn px-6 py-3 text-sm font-medium text-gray-500 hover:text-red-600">
                    Apoiadores
                </button>
                <button onclick="showAdminTab('about')" class="admin-tab-btn px-6 py-3 text-sm font-medium text-gray-500 hover:text-red-600">
                    Editar Sobre
                </button>
            </div>
        </nav>

        <div class="p-4">
            <!-- Aba Usuários -->
            <div id="adminUsersTab" class="admin-tab-content">
                <div class="bg-white rounded-lg shadow p-6 mb-6">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-xl font-bold text-gray-800">Gerenciar Usuários</h2>
                        <button onclick="showAddUserForm()" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700">
                            Adicionar Usuário
                        </button>
                    </div>
                    
                    <!-- Lista de Usuários -->
                    <div id="usersList" class="space-y-3">
                        <!-- Usuários serão listados aqui -->
                    </div>
                </div>

                <!-- Seção Gerar Nova Senha -->
                <div class="bg-white rounded-lg shadow p-6">
                    <h3 class="text-lg font-semibold mb-4">Gerar Nova Senha para Usuário</h3>
                    <form id="generatePasswordForm" class="flex gap-4">
                        <div class="flex-1">
                            <select id="userSelectPassword" class="w-full px-3 py-2 border rounded-lg">
                                <option value="">Selecione um usuário...</option>
                            </select>
                        </div>
                        <button type="submit" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700">
                            Gerar Nova Senha
                        </button>
                    </form>
                </div>
            </div>

            <!-- Aba Configurações -->
            <div id="adminSettingsTab" class="admin-tab-content hidden">
                <div class="bg-white rounded-lg shadow p-6 mb-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-6">Configurações do Sistema</h2>
                    
                    <div class="space-y-6">
                        <!-- Configurações de Contato -->
                        <div class="border-b pb-6">
                            <h3 class="text-lg font-semibold mb-4">📞 Informações de Contato</h3>
                            <form id="contactSettingsForm" class="space-y-4">
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Email de Contato</label>
                                        <input type="email" id="contactEmail" placeholder="contato@exemplo.com"
                                               class="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-red-500">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">WhatsApp de Contato</label>
                                        <input type="tel" id="contactWhatsapp" placeholder="(67) 99999-9999"
                                               class="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-red-500">
                                    </div>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Mensagem Padrão para Apoiadores</label>
                                    <textarea id="supporterMessage" rows="3" placeholder="Mensagem que será enviada quando apoiadores entrarem em contato..."
                                              class="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-red-500"></textarea>
                                </div>
                                <button type="submit" class="bg-red-600 text-white px-6 py-2 rounded-lg hover:bg-red-700">
                                    Salvar Configurações de Contato
                                </button>
                            </form>
                        </div>
                        <div>
                            <h3 class="text-lg font-semibold mb-3">Logo do Aplicativo</h3>
                            <div class="flex items-center space-x-4">
                                <div class="w-16 h-16 bg-green-600 rounded-full flex items-center justify-center" id="adminAppLogoPreview">
                                    <span class="text-white font-bold text-xl">$</span>
                                </div>
                                <div>
                                    <input type="file" id="appLogoInput" accept="image/*" class="hidden">
                                    <button onclick="document.getElementById('appLogoInput').click()" 
                                            class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 mb-2 block">
                                        Escolher Imagem
                                    </button>
                                    <p class="text-xs text-gray-500">Formatos: JPG, PNG, GIF (máx. 2MB)</p>
                                </div>
                            </div>
                        </div>

                        <div>
                            <h3 class="text-lg font-semibold mb-3">Logo do Desenvolvedor</h3>
                            <div class="flex items-center space-x-4">
                                <div class="w-16 h-16 bg-gray-600 rounded-lg flex items-center justify-center" id="devLogoPreview">
                                    <span class="text-white font-bold text-xs">EEJLB</span>
                                </div>
                                <div>
                                    <input type="file" id="devLogoInput" accept="image/png,image/jpeg" class="hidden">
                                    <button onclick="document.getElementById('devLogoInput').click()" 
                                            class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 mb-2 block">
                                        Escolher Imagem
                                    </button>
                                    <button onclick="saveDevLogo()" id="saveDevLogoBtn" 
                                            class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 mb-2 block disabled:bg-gray-400" disabled>
                                        Salvar Alteração
                                    </button>
                                    <p class="text-xs text-gray-500">Formatos: PNG, JPEG (máx. 2MB)</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Aba Apoiadores Admin -->
            <div id="adminSupportersTab" class="admin-tab-content hidden">
                <div class="bg-white rounded-lg shadow p-6 mb-6">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-xl font-bold text-gray-800">Gerenciar Apoiadores</h2>
                        <button onclick="showAddSupporterForm()" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700">
                            Adicionar Apoiador
                        </button>
                    </div>
                    
                    <!-- Lista de Apoiadores -->
                    <div id="adminSupportersList" class="space-y-4">
                        <!-- Apoiadores serão listados aqui -->
                    </div>
                </div>
            </div>

            <!-- Aba Editar Sobre -->
            <div id="adminAboutTab" class="admin-tab-content hidden">
                <div class="bg-white rounded-lg shadow p-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-6">Editar Informações da Aba Sobre</h2>
                    
                    <form id="editAboutForm" class="space-y-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Descrição do Projeto</label>
                            <textarea id="projectDescription" rows="4" class="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-red-500">O Volante Financeiro é um aplicativo desenvolvido especialmente para motoristas de aplicativo e profissionais do transporte em Corumbá-MS e Ladário-MS. O sistema permite organizar despesas pessoais e operacionais, planejar ganhos, monitorar custos e otimizar a rentabilidade, adaptando-se à realidade local da região.</textarea>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Equipe de Desenvolvimento</label>
                                <textarea id="devTeam" rows="4" class="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-red-500">• João Victor Ribeiro de Souza
• Odilon Chalis
• Thaviny Maria Moraes de Toledo Soares
• Wallace Kauã Samosa Coronel</textarea>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Professores Responsáveis</label>
                                <textarea id="teachers" rows="4" class="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-red-500">• Gabriela Luiza da Costa Neves
• Wellington Cesar de Oliveira</textarea>
                            </div>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Nome da Escola</label>
                            <input type="text" id="schoolName" value="Escola Estadual Dr. João Leite de Barros" 
                                   class="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-red-500">
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Versão do Sistema</label>
                            <input type="text" id="systemVersion" value="1.0 - 2024" 
                                   class="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-red-500">
                        </div>

                        <button type="submit" class="bg-red-600 text-white px-6 py-3 rounded-lg hover:bg-red-700 font-semibold">
                            Salvar Alterações
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Adicionar Apoiador -->
    <div id="addSupporterModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
        <div class="bg-white rounded-lg p-6 w-full max-w-md max-h-[90vh] overflow-y-auto">
            <h3 class="text-lg font-bold mb-4">Adicionar Apoiador</h3>
            <form id="addSupporterForm" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Nome da Empresa</label>
                    <input type="text" id="supporterName" required
                           class="w-full px-3 py-2 border rounded-lg">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Descrição</label>
                    <textarea id="supporterDescription" rows="3" 
                              class="w-full px-3 py-2 border rounded-lg"></textarea>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Website (opcional)</label>
                    <input type="url" id="supporterWebsite" placeholder="https://exemplo.com"
                           class="w-full px-3 py-2 border rounded-lg">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Telefone (opcional)</label>
                    <input type="tel" id="supporterPhone" placeholder="(67) 99999-9999"
                           class="w-full px-3 py-2 border rounded-lg">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Logo da Empresa</label>
                    <input type="file" id="supporterLogo" accept="image/*"
                           class="w-full px-3 py-2 border rounded-lg">
                    <p class="text-xs text-gray-500 mt-1">Formatos: JPG, PNG, GIF (máx. 2MB)</p>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Tipo de Apoio</label>
                    <select id="supporterType" required class="w-full px-3 py-2 border rounded-lg">
                        <option value="">Selecione...</option>
                        <option value="Patrocinador Principal">Patrocinador Principal</option>
                        <option value="Patrocinador">Patrocinador</option>
                        <option value="Apoiador">Apoiador</option>
                        <option value="Parceiro">Parceiro</option>
                    </select>
                </div>
                <div class="flex space-x-3">
                    <button type="submit" class="flex-1 bg-green-600 text-white py-2 rounded hover:bg-green-700">
                        Adicionar
                    </button>
                    <button type="button" onclick="hideAddSupporterForm()" class="flex-1 bg-gray-500 text-white py-2 rounded hover:bg-gray-600">
                        Cancelar
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Adicionar Usuário -->
    <div id="addUserModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
        <div class="bg-white rounded-lg p-6 w-full max-w-md">
            <h3 class="text-lg font-bold mb-4">Adicionar Novo Usuário</h3>
            <form id="adminAddUserForm" class="space-y-4">
                <input type="text" id="adminUserName" placeholder="Nome Completo" required
                       class="w-full px-3 py-2 border rounded-lg">
                <input type="text" id="adminUserCpf" placeholder="CPF" required
                       class="w-full px-3 py-2 border rounded-lg">
                <input type="number" id="adminUserAge" placeholder="Idade" min="18" required
                       class="w-full px-3 py-2 border rounded-lg">
                <input type="email" id="adminUserEmail" placeholder="Email" required
                       class="w-full px-3 py-2 border rounded-lg">
                <input type="tel" id="adminUserWhatsapp" placeholder="WhatsApp: (67) 99999-9999" required
                       class="w-full px-3 py-2 border rounded-lg">
                <input type="password" id="adminUserPassword" placeholder="Senha" required
                       class="w-full px-3 py-2 border rounded-lg">
                <select id="adminUserPlatform" required class="w-full px-3 py-2 border rounded-lg">
                    <option value="">Selecione a plataforma...</option>
                    <option value="BR Car">BR Car</option>
                    <option value="IBolt">IBolt</option>
                    <option value="Ifood">Ifood</option>
                    <option value="InDriver">InDriver</option>
                    <option value="Uber">Uber</option>
                    <option value="Tô Aqui">Tô Aqui</option>
                    <option value="Taxi-Connect">Taxi-Connect</option>
                    <option value="Urban">Urban</option>
                    <option value="Outros">Outros</option>
                </select>
                <div class="flex space-x-3">
                    <button type="submit" class="flex-1 bg-green-600 text-white py-2 rounded hover:bg-green-700">
                        Adicionar
                    </button>
                    <button type="button" onclick="hideAddUserForm()" class="flex-1 bg-gray-500 text-white py-2 rounded hover:bg-gray-600">
                        Cancelar
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Dados simulados em localStorage
        let users = JSON.parse(localStorage.getItem('volante_users') || '[]');
        let currentUser = null;
        let earnings = JSON.parse(localStorage.getItem('volante_earnings') || '[]');
        let expenses = JSON.parse(localStorage.getItem('volante_expenses') || '[]');
        let savings = JSON.parse(localStorage.getItem('volante_savings') || '[]');
        let supporters = JSON.parse(localStorage.getItem('volante_supporters') || '[]');
        let goals = JSON.parse(localStorage.getItem('volante_goals') || '[]');

        // Inicialização
        document.addEventListener('DOMContentLoaded', function() {
            // Definir data atual nos campos de data
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('earningDate').value = today;
            document.getElementById('expenseDate').value = today;
            document.getElementById('goalDate').value = new Date(Date.now() + 30*24*60*60*1000).toISOString().split('T')[0]; // 30 dias no futuro



            // Carregar dados salvos do login
            loadRememberedLogin();
            
            // Definir mês atual no seletor de análises
            document.getElementById('analyticsMonth').value = new Date().toISOString().slice(0, 7);

            // Event listeners
            document.getElementById('loginForm').addEventListener('submit', handleLogin);
            document.getElementById('registerForm').addEventListener('submit', handleRegister);
            document.getElementById('resetForm').addEventListener('submit', handlePasswordReset);
            document.getElementById('adminLoginForm').addEventListener('submit', handleAdminLogin);
            document.getElementById('earningsForm').addEventListener('submit', handleAddEarning);
            document.getElementById('expensesForm').addEventListener('submit', handleAddExpense);
            document.getElementById('savingsForm').addEventListener('submit', handleAddSaving);
            document.getElementById('adminAddUserForm').addEventListener('submit', handleAdminAddUser);
            document.getElementById('generatePasswordForm').addEventListener('submit', handleGeneratePassword);
            document.getElementById('editAboutForm').addEventListener('submit', handleEditAbout);
            document.getElementById('addSupporterForm').addEventListener('submit', handleAddSupporter);
            document.getElementById('goalsForm').addEventListener('submit', handleAddGoal);
            document.getElementById('contactSettingsForm').addEventListener('submit', handleContactSettings);

            // Carregar configurações de contato salvas
            loadContactSettings();

            // Formatação de CPF e WhatsApp
            document.getElementById('loginCpf').addEventListener('input', function(e) {
                formatCPF(e);
                validateCPFRealTime(e);
            });
            document.getElementById('regCpf').addEventListener('input', formatCPF);
            document.getElementById('adminUserCpf').addEventListener('input', formatCPF);
            document.getElementById('regWhatsapp').addEventListener('input', formatWhatsApp);
            document.getElementById('adminUserWhatsapp').addEventListener('input', formatWhatsApp);
            document.getElementById('contactWhatsapp').addEventListener('input', formatWhatsApp);

            // Upload de imagens
            document.getElementById('appLogoInput').addEventListener('change', handleAppLogoUpload);
            document.getElementById('devLogoInput').addEventListener('change', handleDevLogoUpload);
        });



        // Função para lidar com login de teste
        function handleTestLogin() {
            try {
                // Verificar se já existe um usuário de teste ativo
                let testUser = users.find(u => u.isTestUser && u.active);
                
                if (!testUser) {
                    // Criar novo usuário de teste
                    const testStartDate = new Date();
                    const testEndDate = new Date(testStartDate.getTime() + 7 * 24 * 60 * 60 * 1000); // 7 dias
                    
                    testUser = {
                        id: Date.now(),
                        name: "Usuário Teste",
                        email: "teste@volantefinanceiro.com",
                        cpf: "000.000.000-00",
                        age: "25",
                        whatsapp: "",
                        password: "teste123",
                        platform: "Teste",
                        active: true,
                        isTestUser: true,
                        testStartDate: testStartDate.toISOString(),
                        testEndDate: testEndDate.toISOString(),
                        picture: null
                    };
                    
                    users.push(testUser);
                    localStorage.setItem('volante_users', JSON.stringify(users));
                    
                    alert(
                        `🎉 Bem-vindo ao Teste Grátis!\n\n` +
                        `Você pode usar o Volante Financeiro por 7 dias.\n` +
                        `Período de teste: ${testStartDate.toLocaleDateString('pt-BR')} até ${testEndDate.toLocaleDateString('pt-BR')}\n\n` +
                        `Aproveite para conhecer todas as funcionalidades!`
                    );
                } else {
                    // Verificar se o período de teste ainda é válido
                    const now = new Date();
                    const testEnd = new Date(testUser.testEndDate);
                    
                    if (now > testEnd) {
                        // Período de teste expirado
                        testUser.active = false;
                        localStorage.setItem('volante_users', JSON.stringify(users));
                        
                        const shouldRegister = confirm(
                            `⏰ Período de teste expirado!\n\n` +
                            `Seu teste de 7 dias terminou em ${testEnd.toLocaleDateString('pt-BR')}.\n` +
                            `Para continuar usando o Volante Financeiro, você precisa fazer seu cadastro.\n\n` +
                            `Deseja se cadastrar agora?`
                        );
                        
                        if (shouldRegister) {
                            showRegister();
                        }
                        return;
                    } else {
                        // Período de teste ainda válido
                        const daysLeft = Math.ceil((testEnd - now) / (1000 * 60 * 60 * 24));
                        alert(
                            `✅ Bem-vindo de volta!\n\n` +
                            `Seu período de teste ainda está ativo.\n` +
                            `Restam ${daysLeft} dia${daysLeft > 1 ? 's' : ''} de teste gratuito.\n\n` +
                            `Aproveite para explorar todas as funcionalidades!`
                        );
                    }
                }

                // Fazer login
                currentUser = testUser;
                document.getElementById('userWelcome').textContent = `Bem-vindo, ${testUser.name}! (Teste)`;
                showDashboard();
                
                // Mostrar aviso de teste no dashboard
                showTestUserWarning();
                
            } catch (error) {
                console.error('Erro no login de teste:', error);
                alert('Erro ao iniciar teste. Tente novamente.');
            }
        }



        // Funções de contato para apoiadores
        function contactSupportWhatsApp() {
            const contactSettings = JSON.parse(localStorage.getItem('volante_contact_settings') || '{}');
            const whatsapp = contactSettings.whatsapp || '67999999999';
            const message = contactSettings.supporterMessage || 'Olá! Gostaria de saber mais sobre como apoiar o projeto Volante Financeiro.';
            
            const whatsappUrl = `https://wa.me/55${whatsapp.replace(/\D/g, '')}?text=${encodeURIComponent(message)}`;
            window.open(whatsappUrl, '_blank');
        }

        function contactSupportEmail() {
            const contactSettings = JSON.parse(localStorage.getItem('volante_contact_settings') || '{}');
            const email = contactSettings.email || 'contato@volantefinanceiro.com';
            const subject = 'Interesse em apoiar o Volante Financeiro';
            const body = contactSettings.supporterMessage || 'Olá! Gostaria de saber mais sobre como apoiar o projeto Volante Financeiro.';
            
            const mailtoUrl = `mailto:${email}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
            window.location.href = mailtoUrl;
        }

        // Função para lidar com configurações de contato
        function handleContactSettings(e) {
            e.preventDefault();
            
            const contactSettings = {
                email: document.getElementById('contactEmail').value,
                whatsapp: document.getElementById('contactWhatsapp').value,
                supporterMessage: document.getElementById('supporterMessage').value
            };
            
            localStorage.setItem('volante_contact_settings', JSON.stringify(contactSettings));
            alert('Configurações de contato salvas com sucesso!');
        }

        // Funções de navegação
        function showLogin() {
            hideAllScreens();
            document.getElementById('loginScreen').classList.remove('hidden');
        }

        function showRegister() {
            hideAllScreens();
            document.getElementById('registerScreen').classList.remove('hidden');
        }

        function showPasswordReset() {
            hideAllScreens();
            document.getElementById('passwordResetScreen').classList.remove('hidden');
        }

        function showAdminLogin() {
            hideAllScreens();
            document.getElementById('adminLoginScreen').classList.remove('hidden');
        }

        function showDashboard() {
            hideAllScreens();
            document.getElementById('dashboardScreen').classList.remove('hidden');
            updateDashboard();
            loadSavedLogos();
            updateAboutTab();
        }

        // Função para mostrar aviso de usuário teste
        function showTestUserWarning() {
            if (currentUser && currentUser.isTestUser) {
                const now = new Date();
                const testEnd = new Date(currentUser.testEndDate);
                const daysLeft = Math.ceil((testEnd - now) / (1000 * 60 * 60 * 24));
                
                // Criar elemento de aviso se não existir
                let warningElement = document.getElementById('testUserWarning');
                if (!warningElement) {
                    warningElement = document.createElement('div');
                    warningElement.id = 'testUserWarning';
                    warningElement.className = 'bg-purple-100 border-l-4 border-purple-500 p-4 mb-4 mx-4';
                    
                    const dashboardContent = document.querySelector('#dashboardScreen .p-4');
                    dashboardContent.insertBefore(warningElement, dashboardContent.firstChild);
                }
                
                warningElement.innerHTML = `
                    <div class="flex items-center justify-between">
                        <div class="flex items-center">
                            <svg class="w-5 h-5 text-purple-500 mr-3" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"/>
                            </svg>
                            <div>
                                <p class="text-purple-800 font-semibold">
                                    🎯 Modo Teste Ativo - ${daysLeft} dia${daysLeft > 1 ? 's' : ''} restante${daysLeft > 1 ? 's' : ''}
                                </p>
                                <p class="text-purple-600 text-sm">
                                    Teste até ${testEnd.toLocaleDateString('pt-BR')}. Faça seu cadastro para continuar usando após o período de teste.
                                </p>
                            </div>
                        </div>
                        <div class="flex space-x-2">
                            <button onclick="showRegister()" class="bg-purple-600 text-white px-4 py-2 rounded-lg text-sm hover:bg-purple-700">
                                Cadastrar Agora
                            </button>
                            <button onclick="hideTestWarning()" class="text-purple-600 hover:text-purple-800 text-sm">
                                ✕
                            </button>
                        </div>
                    </div>
                `;
            }
        }

        // Função para esconder aviso de teste
        function hideTestWarning() {
            const warningElement = document.getElementById('testUserWarning');
            if (warningElement) {
                warningElement.style.display = 'none';
            }
        }

        function showAdminDashboard() {
            hideAllScreens();
            document.getElementById('adminDashboard').classList.remove('hidden');
            loadUsersList();
            updateUserSelectOptions();
            loadSavedLogos();
            loadAboutInfo();
            loadAdminSupportersList();
        }

        function hideAllScreens() {
            const screens = ['loginScreen', 'registerScreen', 'passwordResetScreen', 'adminLoginScreen', 'dashboardScreen', 'adminDashboard'];
            screens.forEach(screen => {
                document.getElementById(screen).classList.add('hidden');
            });
        }

        // Função para carregar dados lembrados do login
        function loadRememberedLogin() {
            const rememberedData = JSON.parse(localStorage.getItem('volante_remembered_login') || '{}');
            if (rememberedData.cpf) {
                document.getElementById('loginCpf').value = rememberedData.cpf;
                document.getElementById('rememberLogin').checked = true;
            }
        }

        // Função para salvar dados do login
        function saveLoginData(cpf, remember) {
            if (remember) {
                localStorage.setItem('volante_remembered_login', JSON.stringify({ cpf: cpf }));
            } else {
                localStorage.removeItem('volante_remembered_login');
            }
        }

        // Funções de autenticação
        function handleLogin(e) {
            e.preventDefault();
            const cpf = document.getElementById('loginCpf').value;
            const password = document.getElementById('loginPassword').value;

            // Verificar se apenas o CPF foi preenchido
            if (cpf && !password) {
                // Verificar se o CPF existe no sistema
                const user = users.find(u => u.cpf === cpf);
                
                if (!user) {
                    // CPF não encontrado - informar e sugerir cadastro
                    alert(
                        '❌ CPF não encontrado!\n\n' +
                        'Este CPF não possui cadastro no sistema.\n' +
                        'Para usar o Volante Financeiro, você precisa fazer seu cadastro primeiro.\n\n' +
                        'Clique em "Cadastrar Nova Conta" para se registrar.'
                    );
                    
                    // Limpar campo CPF e focar nele
                    document.getElementById('loginCpf').value = '';
                    document.getElementById('loginCpf').focus();
                    return;
                } else {
                    // CPF encontrado - solicitar senha
                    alert(
                        '✅ CPF encontrado!\n\n' +
                        `Olá, ${user.name}!\n` +
                        'Sua conta existe no sistema.\n' +
                        'Agora digite sua senha para entrar.'
                    );
                    
                    // Focar no campo senha
                    document.getElementById('loginPassword').focus();
                    return;
                }
            }

            // Verificar se ambos os campos estão preenchidos
            if (!cpf || !password) {
                alert('Por favor, preencha CPF e senha para fazer login!');
                
                // Focar no primeiro campo vazio
                if (!cpf) {
                    document.getElementById('loginCpf').focus();
                } else {
                    document.getElementById('loginPassword').focus();
                }
                return;
            }

            // Ambos os campos preenchidos - fazer validação completa
            const user = users.find(u => u.cpf === cpf);
            
            if (!user) {
                // CPF não encontrado
                const shouldRegister = confirm(
                    '❌ CPF não cadastrado!\n\n' +
                    'Este CPF não possui cadastro no sistema.\n' +
                    'Você precisa fazer seu cadastro primeiro.\n\n' +
                    'Deseja ir para a tela de cadastro agora?\n' +
                    '(Seu CPF será preenchido automaticamente)'
                );
                
                if (shouldRegister) {
                    // Ir para cadastro com CPF pré-preenchido
                    showRegister();
                    document.getElementById('regCpf').value = cpf;
                    document.getElementById('regName').focus();
                } else {
                    // Limpar campos e focar no CPF
                    document.getElementById('loginCpf').value = '';
                    document.getElementById('loginPassword').value = '';
                    document.getElementById('loginCpf').focus();
                }
                return;
            }

            // CPF existe, verificar senha
            if (user.password !== password) {
                alert(
                    '❌ Senha incorreta!\n\n' +
                    `CPF: ${cpf} ✅ (encontrado)\n` +
                    `Usuário: ${user.name}\n\n` +
                    'A senha digitada está incorreta.\n' +
                    'Verifique sua senha e tente novamente.\n\n' +
                    'Esqueceu sua senha? Use a opção "Esqueci minha senha".'
                );
                
                // Limpar apenas o campo senha e focar nele
                document.getElementById('loginPassword').value = '';
                document.getElementById('loginPassword').focus();
                return;
            }

            // Verificar se a conta está ativa
            if (!user.active) {
                alert(
                    '⚠️ Conta pausada!\n\n' +
                    `Olá, ${user.name}!\n` +
                    'Sua conta está temporariamente pausada pelo administrador.\n\n' +
                    'Entre em contato com o suporte para reativar sua conta.'
                );
                return;
            }

            // Login bem-sucedido
            currentUser = user;
            document.getElementById('userWelcome').textContent = `Bem-vindo, ${user.name}!`;
            
            // Salvar dados se "lembrar login" estiver marcado
            const rememberLogin = document.getElementById('rememberLogin').checked;
            saveLoginData(cpf, rememberLogin);
            
            showDashboard();
            
            // Limpar formulário
            document.getElementById('loginForm').reset();
            
            // Restaurar checkbox se estava marcado
            if (rememberLogin) {
                document.getElementById('rememberLogin').checked = true;
            }
        }

        function handleRegister(e) {
            e.preventDefault();
            const cpf = document.getElementById('regCpf').value;
            
            // Verificar se usuário já existe
            if (users.find(u => u.cpf === cpf)) {
                alert('Este CPF já possui cadastro no sistema!');
                return;
            }

            const newUser = {
                id: Date.now(),
                name: document.getElementById('regName').value,
                cpf: cpf,
                age: document.getElementById('regAge').value,
                email: document.getElementById('regEmail').value,
                whatsapp: document.getElementById('regWhatsapp').value,
                password: document.getElementById('regPassword').value,
                platform: document.getElementById('regPlatform').value,
                active: true
            };

            users.push(newUser);
            localStorage.setItem('volante_users', JSON.stringify(users));
            
            alert('Cadastro realizado com sucesso!');
            showLogin();
        }

        function handlePasswordReset(e) {
            e.preventDefault();
            const email = document.getElementById('resetEmail').value;
            
            const user = users.find(u => u.email === email);
            if (user) {
                alert(`Nova senha enviada para ${email}!\n(Esta é uma demonstração - em produção seria enviado por email real)`);
                showLogin();
            } else {
                alert('Email não encontrado no sistema!');
            }
        }

        function handleAdminLogin(e) {
            e.preventDefault();
            const password = document.getElementById('adminPassword').value;
            
            if (password === 'jlb@1964') {
                showAdminDashboard();
            } else {
                alert('Senha de administrador incorreta!');
            }
        }

        function logout() {
            currentUser = null;
            showLogin();
        }

        // Funções de formatação
        function formatCPF(e) {
            let value = e.target.value.replace(/\D/g, '');
            value = value.replace(/(\d{3})(\d)/, '$1.$2');
            value = value.replace(/(\d{3})(\d)/, '$1.$2');
            value = value.replace(/(\d{3})(\d{1,2})$/, '$1-$2');
            e.target.value = value;
        }

        // Validação de CPF em tempo real
        function validateCPFRealTime(e) {
            const cpf = e.target.value;
            const cpfInput = e.target;
            const messageDiv = document.getElementById('cpfValidationMessage');
            
            // Só validar se o CPF estiver completo (11 dígitos)
            if (cpf.replace(/\D/g, '').length === 11) {
                // Verificar se é um CPF válido
                if (!isValidCPF(cpf)) {
                    // CPF inválido
                    cpfInput.className = 'w-full px-4 py-3 border-2 border-red-500 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500 transition-all duration-300 bg-red-50';
                    messageDiv.className = 'mt-1 text-sm text-red-600';
                    messageDiv.textContent = '❌ CPF inválido - Digite um CPF real';
                    messageDiv.classList.remove('hidden');
                    return;
                }

                // CPF válido - verificar se existe no sistema
                const user = users.find(u => u.cpf === cpf);
                
                if (user) {
                    // CPF encontrado no sistema
                    cpfInput.className = 'w-full px-4 py-3 border-2 border-green-500 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-all duration-300 bg-green-50';
                    messageDiv.className = 'mt-1 text-sm text-green-600';
                    messageDiv.textContent = `✅ CPF encontrado - ${user.name}`;
                    messageDiv.classList.remove('hidden');
                } else {
                    // CPF válido mas não cadastrado
                    cpfInput.className = 'w-full px-4 py-3 border-2 border-red-500 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500 transition-all duration-300 bg-red-50';
                    messageDiv.className = 'mt-1 text-sm text-red-600';
                    messageDiv.textContent = '❌ CPF não cadastrado - Faça seu cadastro primeiro';
                    messageDiv.classList.remove('hidden');
                }
            } else {
                // CPF incompleto - resetar estilo
                cpfInput.className = 'w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all duration-300';
                messageDiv.classList.add('hidden');
            }
        }

        // Função para validar CPF
        function isValidCPF(cpf) {
            cpf = cpf.replace(/\D/g, '');
            
            if (cpf.length !== 11) return false;
            
            // Verificar se todos os dígitos são iguais
            if (/^(\d)\1{10}$/.test(cpf)) return false;
            
            // Validar primeiro dígito verificador
            let sum = 0;
            for (let i = 0; i < 9; i++) {
                sum += parseInt(cpf.charAt(i)) * (10 - i);
            }
            let remainder = 11 - (sum % 11);
            if (remainder === 10 || remainder === 11) remainder = 0;
            if (remainder !== parseInt(cpf.charAt(9))) return false;
            
            // Validar segundo dígito verificador
            sum = 0;
            for (let i = 0; i < 10; i++) {
                sum += parseInt(cpf.charAt(i)) * (11 - i);
            }
            remainder = 11 - (sum % 11);
            if (remainder === 10 || remainder === 11) remainder = 0;
            if (remainder !== parseInt(cpf.charAt(10))) return false;
            
            return true;
        }

        function formatWhatsApp(e) {
            let value = e.target.value.replace(/\D/g, '');
            value = value.replace(/(\d{2})(\d)/, '($1) $2');
            value = value.replace(/(\d{5})(\d)/, '$1-$2');
            e.target.value = value;
        }

        // Funções de abas
        function showTab(tabName) {
            // Esconder todas as abas
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.add('hidden');
            });
            
            // Remover classe ativa de todos os botões
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('border-green-600', 'text-green-600');
                btn.classList.add('text-gray-500');
            });
            
            // Mostrar aba selecionada
            document.getElementById(tabName + 'Tab').classList.remove('hidden');
            
            // Ativar botão correspondente
            event.target.classList.add('border-green-600', 'text-green-600');
            event.target.classList.remove('text-gray-500');

            if (tabName === 'analytics') {
                updateAnalytics();
            }
        }

        function showAdminTab(tabName) {
            // Esconder todas as abas admin
            document.querySelectorAll('.admin-tab-content').forEach(tab => {
                tab.classList.add('hidden');
            });
            
            // Remover classe ativa de todos os botões admin
            document.querySelectorAll('.admin-tab-btn').forEach(btn => {
                btn.classList.remove('border-red-600', 'text-red-600');
                btn.classList.add('text-gray-500');
            });
            
            // Mostrar aba selecionada
            document.getElementById('admin' + tabName.charAt(0).toUpperCase() + tabName.slice(1) + 'Tab').classList.remove('hidden');
            
            // Ativar botão correspondente
            event.target.classList.add('border-red-600', 'text-red-600');
            event.target.classList.remove('text-gray-500');
        }

        // Funções de ganhos
        function handleAddEarning(e) {
            e.preventDefault();
            
            const earning = {
                id: Date.now(),
                userId: currentUser.id,
                platform: document.getElementById('earningPlatform').value,
                amount: parseFloat(document.getElementById('earningAmount').value),
                date: document.getElementById('earningDate').value,
                type: document.getElementById('earningType').value
            };

            earnings.push(earning);
            localStorage.setItem('volante_earnings', JSON.stringify(earnings));
            
            document.getElementById('earningsForm').reset();
            document.getElementById('earningDate').value = new Date().toISOString().split('T')[0];
            
            updateEarningsList();
            alert('Ganho adicionado com sucesso!');
        }

        function updateEarningsList() {
            const userEarnings = earnings.filter(e => e.userId === currentUser.id);
            const list = document.getElementById('earningsList');
            
            if (userEarnings.length === 0) {
                list.innerHTML = '<p class="text-gray-500">Nenhum ganho registrado ainda.</p>';
                return;
            }

            list.innerHTML = userEarnings.slice(-5).reverse().map(earning => `
                <div class="flex justify-between items-center p-3 bg-green-50 rounded-lg">
                    <div>
                        <p class="font-semibold">${earning.platform} - ${earning.type}</p>
                        <p class="text-sm text-gray-600">${new Date(earning.date).toLocaleDateString('pt-BR')}</p>
                    </div>
                    <div class="flex items-center space-x-2">
                        <span class="font-bold text-green-600">R$ ${earning.amount.toFixed(2)}</span>
                        <button onclick="editEarning(${earning.id})" class="text-blue-600 hover:text-blue-800 text-sm">
                            ✏️
                        </button>
                        <button onclick="deleteEarning(${earning.id})" class="text-red-600 hover:text-red-800 text-sm">
                            🗑️
                        </button>
                    </div>
                </div>
            `).join('');
        }

        // Funções de despesas
        function handleAddExpense(e) {
            e.preventDefault();
            
            const expense = {
                id: Date.now(),
                userId: currentUser.id,
                category: document.getElementById('expenseCategory').value,
                amount: parseFloat(document.getElementById('expenseAmount').value),
                date: document.getElementById('expenseDate').value,
                description: document.getElementById('expenseDescription').value
            };

            expenses.push(expense);
            localStorage.setItem('volante_expenses', JSON.stringify(expenses));
            
            document.getElementById('expensesForm').reset();
            document.getElementById('expenseDate').value = new Date().toISOString().split('T')[0];
            
            updateExpensesList();
            alert('Despesa adicionada com sucesso!');
        }

        function updateExpensesList() {
            const userExpenses = expenses.filter(e => e.userId === currentUser.id);
            const list = document.getElementById('expensesList');
            
            if (userExpenses.length === 0) {
                list.innerHTML = '<p class="text-gray-500">Nenhuma despesa registrada ainda.</p>';
                return;
            }

            list.innerHTML = userExpenses.slice(-5).reverse().map(expense => `
                <div class="flex justify-between items-center p-3 bg-red-50 rounded-lg">
                    <div>
                        <p class="font-semibold">${expense.category}</p>
                        <p class="text-sm text-gray-600">${expense.description || 'Sem descrição'}</p>
                        <p class="text-xs text-gray-500">${new Date(expense.date).toLocaleDateString('pt-BR')}</p>
                    </div>
                    <div class="flex items-center space-x-2">
                        <span class="font-bold text-red-600">R$ ${expense.amount.toFixed(2)}</span>
                        <button onclick="editExpense(${expense.id})" class="text-blue-600 hover:text-blue-800 text-sm">
                            ✏️
                        </button>
                        <button onclick="deleteExpense(${expense.id})" class="text-red-600 hover:text-red-800 text-sm">
                            🗑️
                        </button>
                    </div>
                </div>
            `).join('');
        }

        // Funções de cofres
        function handleAddSaving(e) {
            e.preventDefault();
            
            const saving = {
                id: Date.now(),
                userId: currentUser.id,
                amount: parseFloat(document.getElementById('savingAmount').value),
                purpose: document.getElementById('savingPurpose').value,
                goal: parseFloat(document.getElementById('savingGoal').value) || null,
                notes: document.getElementById('savingNotes').value,
                date: new Date().toISOString().split('T')[0]
            };

            savings.push(saving);
            localStorage.setItem('volante_savings', JSON.stringify(savings));
            
            document.getElementById('savingsForm').reset();
            updateSavingsSummary();
            updateSavingsHistory();
            alert('💰 Dinheiro guardado no cofre com sucesso!');
        }

        function updateSavingsSummary() {
            const userSavings = savings.filter(s => s.userId === currentUser.id);
            const summary = document.getElementById('savingsSummary');
            const totalElement = document.getElementById('totalSavingsAmount');
            
            // Calcular total geral
            const totalAmount = userSavings.reduce((sum, s) => sum + s.amount, 0);
            if (totalElement) {
                totalElement.textContent = `R$ ${totalAmount.toFixed(2)}`;
            }
            
            // Agrupar por finalidade
            const purposeGroups = userSavings.reduce((groups, saving) => {
                const purpose = saving.purpose;
                if (!groups[purpose]) {
                    groups[purpose] = { total: 0, goal: null, items: [] };
                }
                groups[purpose].total += saving.amount;
                groups[purpose].items.push(saving);
                if (saving.goal && saving.goal > groups[purpose].goal) {
                    groups[purpose].goal = saving.goal;
                }
                return groups;
            }, {});
            
            if (Object.keys(purposeGroups).length === 0) {
                summary.innerHTML = '<div class="col-span-full text-center text-gray-500 py-8">Nenhum cofre criado ainda. Comece guardando dinheiro!</div>';
                return;
            }

            summary.innerHTML = Object.entries(purposeGroups).map(([purpose, data]) => {
                const progress = data.goal ? (data.total / data.goal) * 100 : 0;
                const emoji = purpose.includes('🚨') ? '🚨' : 
                             purpose.includes('🔧') ? '🔧' : 
                             purpose.includes('📈') ? '📈' : 
                             purpose.includes('🚗') ? '🚗' : 
                             purpose.includes('🛡️') ? '🛡️' : 
                             purpose.includes('🏖️') ? '🏖️' : '💰';
                
                return `
                    <div class="bg-gradient-to-br from-blue-50 to-blue-100 rounded-lg p-4 border border-blue-200">
                        <div class="flex items-center justify-between mb-2">
                            <h4 class="font-semibold text-blue-800 flex items-center">
                                <span class="text-xl mr-2">${emoji}</span>
                                ${purpose.replace(/[🚨🔧📈🚗🛡️🏖️💼]/g, '').trim()}
                            </h4>
                            <button onclick="withdrawFromSaving('${purpose}')" class="text-red-500 hover:text-red-700 text-sm">
                                💸 Retirar
                            </button>
                        </div>
                        <p class="text-2xl font-bold text-blue-600 mb-2">R$ ${data.total.toFixed(2)}</p>
                        ${data.goal ? `
                            <div class="mb-2">
                                <div class="flex justify-between text-xs text-gray-600 mb-1">
                                    <span>Meta: R$ ${data.goal.toFixed(2)}</span>
                                    <span>${progress.toFixed(1)}%</span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-2">
                                    <div class="bg-blue-600 h-2 rounded-full transition-all duration-300" 
                                         style="width: ${Math.min(progress, 100)}%"></div>
                                </div>
                            </div>
                        ` : ''}
                        <p class="text-xs text-gray-600">${data.items.length} movimentação${data.items.length > 1 ? 'ões' : ''}</p>
                    </div>
                `;
            }).join('');
        }

        function updateSavingsHistory() {
            const userSavings = savings.filter(s => s.userId === currentUser.id);
            const history = document.getElementById('savingsHistory');
            
            if (userSavings.length === 0) {
                history.innerHTML = '<p class="text-gray-500 text-center py-4">Nenhuma movimentação ainda.</p>';
                return;
            }

            history.innerHTML = userSavings.slice(-10).reverse().map(saving => `
                <div class="flex justify-between items-center p-3 bg-blue-50 rounded-lg border border-blue-200">
                    <div>
                        <p class="font-semibold text-blue-800">${saving.purpose.replace(/[🚨🔧📈🚗🛡️🏖️💼]/g, '').trim()}</p>
                        <p class="text-sm text-gray-600">${new Date(saving.date).toLocaleDateString('pt-BR')}</p>
                        ${saving.notes ? `<p class="text-xs text-gray-500">${saving.notes}</p>` : ''}
                    </div>
                    <div class="text-right">
                        <span class="font-bold text-blue-600">+ R$ ${saving.amount.toFixed(2)}</span>
                        <div class="flex space-x-1 mt-1">
                            <button onclick="editSaving(${saving.id})" class="text-blue-600 hover:text-blue-800 text-xs">
                                ✏️
                            </button>
                            <button onclick="deleteSaving(${saving.id})" class="text-red-600 hover:text-red-800 text-xs">
                                🗑️
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function withdrawFromSaving(purpose) {
            const userSavings = savings.filter(s => s.userId === currentUser.id && s.purpose === purpose);
            const total = userSavings.reduce((sum, s) => sum + s.amount, 0);
            
            if (total <= 0) {
                alert('Este cofre está vazio!');
                return;
            }

            const amount = prompt(`Cofre: ${purpose.replace(/[🚨🔧📈🚗🛡️🏖️💼]/g, '').trim()}\nSaldo: R$ ${total.toFixed(2)}\n\nQuanto deseja retirar?`);
            
            if (amount && !isNaN(amount) && parseFloat(amount) > 0) {
                const withdrawAmount = parseFloat(amount);
                
                if (withdrawAmount > total) {
                    alert('Valor maior que o saldo disponível!');
                    return;
                }

                // Criar registro de retirada (valor negativo)
                const withdrawal = {
                    id: Date.now(),
                    userId: currentUser.id,
                    amount: -withdrawAmount,
                    purpose: purpose,
                    notes: `Retirada do cofre`,
                    date: new Date().toISOString().split('T')[0]
                };

                savings.push(withdrawal);
                localStorage.setItem('volante_savings', JSON.stringify(savings));
                
                updateSavingsSummary();
                updateSavingsHistory();
                alert(`💸 R$ ${withdrawAmount.toFixed(2)} retirado do cofre com sucesso!`);
            }
        }

        function editSaving(id) {
            const saving = savings.find(s => s.id === id);
            if (saving && saving.amount > 0) { // Só editar depósitos, não retiradas
                document.getElementById('savingAmount').value = saving.amount;
                document.getElementById('savingPurpose').value = saving.purpose;
                document.getElementById('savingGoal').value = saving.goal || '';
                document.getElementById('savingNotes').value = saving.notes || '';
                
                // Remover o registro original
                savings = savings.filter(s => s.id !== id);
                localStorage.setItem('volante_savings', JSON.stringify(savings));
                updateSavingsSummary();
                updateSavingsHistory();
                
                alert('Movimentação carregada para edição. Faça as alterações e clique em "Guardar no Cofre".');
            }
        }

        function deleteSaving(id) {
            if (confirm('Tem certeza que deseja excluir esta movimentação?')) {
                savings = savings.filter(s => s.id !== id);
                localStorage.setItem('volante_savings', JSON.stringify(savings));
                updateSavingsSummary();
                updateSavingsHistory();
                alert('Movimentação excluída com sucesso!');
            }
        }

        // Função para atualizar período das análises
        function updateAnalyticsPeriod() {
            const period = document.getElementById('analyticsPeriod').value;
            const monthInput = document.getElementById('analyticsMonth');
            const summaryTitle = document.getElementById('summaryTitle');
            
            // Atualizar título baseado no período
            const titles = {
                'daily': '📅 Resumo Diário',
                'weekly': '📊 Resumo Semanal', 
                'monthly': '📈 Resumo Mensal',
                'yearly': '🗓️ Resumo Anual'
            };
            
            summaryTitle.textContent = titles[period] || 'Resumo';
            
            // Mostrar/esconder seletor de mês baseado no período
            if (period === 'yearly') {
                monthInput.type = 'number';
                monthInput.placeholder = 'Ano (ex: 2024)';
                monthInput.value = new Date().getFullYear();
            } else {
                monthInput.type = 'month';
                monthInput.placeholder = '';
                monthInput.value = new Date().toISOString().slice(0, 7);
            }
            
            // Atualizar análises com novo período
            updateAnalytics();
        }

        // Funções de análises
        function updateAnalytics() {
            const period = document.getElementById('analyticsPeriod').value;
            const selectedDate = document.getElementById('analyticsMonth').value;
            
            // Filtrar dados baseado no período selecionado
            const filteredEarnings = filterDataByPeriod(earnings.filter(e => e.userId === currentUser.id), period, selectedDate);
            const filteredExpenses = filterDataByPeriod(expenses.filter(e => e.userId === currentUser.id), period, selectedDate);
            const filteredSavings = filterDataByPeriod(savings.filter(s => s.userId === currentUser.id), period, selectedDate);

            const totalEarnings = filteredEarnings.reduce((sum, e) => sum + e.amount, 0);
            const totalExpenses = filteredExpenses.reduce((sum, e) => sum + e.amount, 0);
            const totalSavings = filteredSavings.reduce((sum, s) => sum + s.amount, 0);
            const netProfit = totalEarnings - totalExpenses - totalSavings;

            document.getElementById('totalEarnings').textContent = `R$ ${totalEarnings.toFixed(2)}`;
            document.getElementById('totalExpenses').textContent = `R$ ${totalExpenses.toFixed(2)}`;
            document.getElementById('totalSavings').textContent = `R$ ${totalSavings.toFixed(2)}`;
            
            const profitElement = document.getElementById('netProfit');
            profitElement.textContent = `R$ ${netProfit.toFixed(2)}`;
            profitElement.className = netProfit >= 0 ? 'font-bold text-green-600' : 'font-bold text-red-600';

            // Atualizar gráfico
            updateChart(filteredEarnings, filteredExpenses, filteredSavings);
        }

        // Função para filtrar dados por período
        function filterDataByPeriod(data, period, selectedDate) {
            if (!selectedDate) return data;
            
            return data.filter(item => {
                const itemDate = new Date(item.date);
                const selected = new Date(selectedDate);
                
                switch (period) {
                    case 'daily':
                        return itemDate.toDateString() === selected.toDateString();
                    
                    case 'weekly':
                        const weekStart = new Date(selected);
                        weekStart.setDate(selected.getDate() - selected.getDay());
                        const weekEnd = new Date(weekStart);
                        weekEnd.setDate(weekStart.getDate() + 6);
                        return itemDate >= weekStart && itemDate <= weekEnd;
                    
                    case 'monthly':
                        return itemDate.getFullYear() === selected.getFullYear() && 
                               itemDate.getMonth() === selected.getMonth();
                    
                    case 'yearly':
                        const year = parseInt(selectedDate);
                        return itemDate.getFullYear() === year;
                    
                    default:
                        return true;
                }
            });
        }

        function updateChart() {
            const ctx = document.getElementById('monthlyChart');
            if (!ctx) return;
            
            // Destruir gráfico existente se houver
            if (window.monthlyChart) {
                window.monthlyChart.destroy();
            }

            const userEarnings = earnings.filter(e => e.userId === currentUser.id);
            const userExpenses = expenses.filter(e => e.userId === currentUser.id);
            const userSavings = savings.filter(s => s.userId === currentUser.id);

            const totalEarnings = userEarnings.reduce((sum, e) => sum + e.amount, 0);
            const totalExpenses = userExpenses.reduce((sum, e) => sum + e.amount, 0);
            const totalSavings = userSavings.reduce((sum, s) => sum + s.amount, 0);

            // Se não há dados, mostrar gráfico vazio
            if (totalEarnings === 0 && totalExpenses === 0 && totalSavings === 0) {
                window.monthlyChart = new Chart(ctx, {
                    type: 'doughnut',
                    data: {
                        labels: ['Sem dados'],
                        datasets: [{
                            data: [1],
                            backgroundColor: ['#e5e7eb'],
                            borderWidth: 0
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: false
                            }
                        }
                    }
                });
                return;
            }

            // Preparar dados para o gráfico
            const chartData = [];
            const chartLabels = [];
            const chartColors = [];

            if (totalEarnings > 0) {
                chartData.push(totalEarnings);
                chartLabels.push(`Ganhos (R$ ${totalEarnings.toFixed(2)})`);
                chartColors.push('#10b981');
            }

            if (totalExpenses > 0) {
                chartData.push(totalExpenses);
                chartLabels.push(`Despesas (R$ ${totalExpenses.toFixed(2)})`);
                chartColors.push('#ef4444');
            }

            if (totalSavings > 0) {
                chartData.push(totalSavings);
                chartLabels.push(`Cofres (R$ ${totalSavings.toFixed(2)})`);
                chartColors.push('#3b82f6');
            }

            window.monthlyChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: chartLabels,
                    datasets: [{
                        data: chartData,
                        backgroundColor: chartColors,
                        borderWidth: 2,
                        borderColor: '#ffffff'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 20,
                                usePointStyle: true,
                                font: {
                                    size: 12
                                }
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const label = context.label || '';
                                    const value = context.parsed;
                                    const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                    const percentage = ((value / total) * 100).toFixed(1);
                                    return `${label}: ${percentage}%`;
                                }
                            }
                        }
                    },
                    animation: {
                        animateRotate: true,
                        duration: 1000
                    }
                }
            });
        }

        // Funções de metas
        function handleAddGoal(e) {
            e.preventDefault();
            
            const goal = {
                id: Date.now(),
                userId: currentUser.id,
                name: document.getElementById('goalName').value,
                amount: parseFloat(document.getElementById('goalAmount').value),
                date: document.getElementById('goalDate').value,
                category: document.getElementById('goalCategory').value,
                description: document.getElementById('goalDescription').value,
                currentAmount: 0,
                completed: false,
                createdDate: new Date().toISOString().split('T')[0]
            };

            goals.push(goal);
            localStorage.setItem('volante_goals', JSON.stringify(goals));
            
            document.getElementById('goalsForm').reset();
            document.getElementById('goalDate').value = new Date(Date.now() + 30*24*60*60*1000).toISOString().split('T')[0];
            updateGoalsList();
            alert('🎯 Meta criada com sucesso!');
        }

        function updateGoalsList() {
            const userGoals = goals.filter(g => g.userId === currentUser.id);
            const list = document.getElementById('goalsList');
            
            if (userGoals.length === 0) {
                list.innerHTML = '<div class="text-center py-8 text-gray-500">Nenhuma meta definida ainda. Crie sua primeira meta!</div>';
                return;
            }

            list.innerHTML = userGoals.map(goal => {
                const progress = (goal.currentAmount / goal.amount) * 100;
                const daysLeft = Math.ceil((new Date(goal.date) - new Date()) / (1000 * 60 * 60 * 24));
                const isOverdue = daysLeft < 0;
                const isCompleted = goal.completed || progress >= 100;
                
                return `
                    <div class="bg-gradient-to-r from-purple-50 to-purple-100 rounded-lg p-6 border border-purple-200 ${isCompleted ? 'opacity-75' : ''}">
                        <div class="flex justify-between items-start mb-4">
                            <div class="flex-1">
                                <div class="flex items-center mb-2">
                                    <span class="text-2xl mr-3">${goal.category.includes('🚗') ? '🚗' : goal.category.includes('🏠') ? '🏠' : goal.category.includes('✈️') ? '✈️' : goal.category.includes('📚') ? '📚' : goal.category.includes('🏥') ? '🏥' : goal.category.includes('💼') ? '💼' : '🎯'}</span>
                                    <h4 class="text-lg font-bold text-purple-800">${goal.name}</h4>
                                    ${isCompleted ? '<span class="ml-2 text-green-600 font-bold">✅ CONCLUÍDA</span>' : ''}
                                </div>
                                <p class="text-sm text-gray-600 mb-2">${goal.description || 'Sem descrição'}</p>
                                <div class="flex items-center space-x-4 text-sm text-gray-600">
                                    <span>Meta: R$ ${goal.amount.toFixed(2)}</span>
                                    <span>Atual: R$ ${goal.currentAmount.toFixed(2)}</span>
                                    <span class="${isOverdue ? 'text-red-600' : daysLeft <= 7 ? 'text-yellow-600' : 'text-gray-600'}">
                                        ${isOverdue ? `${Math.abs(daysLeft)} dias atrasado` : `${daysLeft} dias restantes`}
                                    </span>
                                </div>
                            </div>
                            <div class="flex space-x-2">
                                ${!isCompleted ? `<button onclick="addToGoal(${goal.id})" class="bg-green-500 text-white px-3 py-1 rounded text-sm hover:bg-green-600">💰 Adicionar</button>` : ''}
                                <button onclick="editGoal(${goal.id})" class="bg-blue-500 text-white px-3 py-1 rounded text-sm hover:bg-blue-600">✏️</button>
                                <button onclick="deleteGoal(${goal.id})" class="bg-red-500 text-white px-3 py-1 rounded text-sm hover:bg-red-600">🗑️</button>
                            </div>
                        </div>
                        
                        <div class="mb-2">
                            <div class="flex justify-between text-sm text-gray-600 mb-1">
                                <span>Progresso</span>
                                <span>${progress.toFixed(1)}%</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-3">
                                <div class="bg-gradient-to-r from-purple-500 to-purple-600 h-3 rounded-full transition-all duration-500" 
                                     style="width: ${Math.min(progress, 100)}%"></div>
                            </div>
                        </div>
                        
                        <div class="text-xs text-gray-500">
                            Criada em ${new Date(goal.createdDate).toLocaleDateString('pt-BR')} • 
                            Prazo: ${new Date(goal.date).toLocaleDateString('pt-BR')}
                        </div>
                    </div>
                `;
            }).join('');
        }

        function addToGoal(goalId) {
            const goal = goals.find(g => g.id === goalId);
            if (!goal) return;

            const remaining = goal.amount - goal.currentAmount;
            const amount = prompt(`Meta: ${goal.name}\nFaltam: R$ ${remaining.toFixed(2)}\n\nQuanto deseja adicionar?`);
            
            if (amount && !isNaN(amount) && parseFloat(amount) > 0) {
                const addAmount = parseFloat(amount);
                goal.currentAmount += addAmount;
                
                if (goal.currentAmount >= goal.amount) {
                    goal.completed = true;
                    alert(`🎉 Parabéns! Você atingiu sua meta "${goal.name}"!`);
                }
                
                localStorage.setItem('volante_goals', JSON.stringify(goals));
                updateGoalsList();
            }
        }

        function editGoal(goalId) {
            const goal = goals.find(g => g.id === goalId);
            if (!goal) return;

            document.getElementById('goalName').value = goal.name;
            document.getElementById('goalAmount').value = goal.amount;
            document.getElementById('goalDate').value = goal.date;
            document.getElementById('goalCategory').value = goal.category;
            document.getElementById('goalDescription').value = goal.description;
            
            // Remover meta original
            goals = goals.filter(g => g.id !== goalId);
            localStorage.setItem('volante_goals', JSON.stringify(goals));
            updateGoalsList();
            
            alert('Meta carregada para edição. Faça as alterações e clique em "Criar Meta".');
        }

        function deleteGoal(goalId) {
            if (confirm('Tem certeza que deseja excluir esta meta?')) {
                goals = goals.filter(g => g.id !== goalId);
                localStorage.setItem('volante_goals', JSON.stringify(goals));
                updateGoalsList();
                alert('Meta excluída com sucesso!');
            }
        }

        // Funções do dashboard
        function updateDashboard() {
            updateEarningsList();
            updateExpensesList();
            updateSavingsSummary();
            updateSavingsHistory();
            updateGoalsList();
            loadSupportersList();
        }

        // Funções administrativas
        function loadUsersList() {
            const list = document.getElementById('usersList');
            
            if (users.length === 0) {
                list.innerHTML = '<p class="text-gray-500">Nenhum usuário cadastrado.</p>';
                return;
            }

            list.innerHTML = users.map(user => `
                <div class="flex justify-between items-center p-4 border rounded-lg ${user.active ? 'bg-white' : 'bg-gray-100'}">
                    <div>
                        <p class="font-semibold">${user.name}</p>
                        <p class="text-sm text-gray-600">${user.cpf} - ${user.email}</p>
                        <p class="text-xs text-gray-500">${user.whatsapp || 'WhatsApp não informado'} - ${user.platform} - ${user.age} anos</p>
                    </div>
                    <div class="flex space-x-2">
                        <button onclick="sendWhatsAppNotification(${user.id})" 
                                class="px-3 py-1 bg-green-500 text-white rounded text-sm hover:bg-green-600">
                            WhatsApp
                        </button>
                        <button onclick="toggleUserStatus(${user.id})" 
                                class="px-3 py-1 rounded text-sm ${user.active ? 'bg-yellow-500 text-white' : 'bg-green-500 text-white'}">
                            ${user.active ? 'Pausar' : 'Ativar'}
                        </button>
                        <button onclick="deleteUser(${user.id})" 
                                class="px-3 py-1 bg-red-500 text-white rounded text-sm hover:bg-red-600">
                            Excluir
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function showAddUserForm() {
            document.getElementById('addUserModal').classList.remove('hidden');
        }

        function hideAddUserForm() {
            document.getElementById('addUserModal').classList.add('hidden');
            document.getElementById('adminAddUserForm').reset();
        }

        function handleAdminAddUser(e) {
            e.preventDefault();
            
            const cpf = document.getElementById('adminUserCpf').value;
            
            if (users.find(u => u.cpf === cpf)) {
                alert('Este CPF já possui cadastro no sistema!');
                return;
            }

            const newUser = {
                id: Date.now(),
                name: document.getElementById('adminUserName').value,
                cpf: cpf,
                age: document.getElementById('adminUserAge').value,
                email: document.getElementById('adminUserEmail').value,
                whatsapp: document.getElementById('adminUserWhatsapp').value,
                password: document.getElementById('adminUserPassword').value,
                platform: document.getElementById('adminUserPlatform').value,
                active: true
            };

            users.push(newUser);
            localStorage.setItem('volante_users', JSON.stringify(users));
            
            hideAddUserForm();
            loadUsersList();
            alert('Usuário adicionado com sucesso!');
        }

        function toggleUserStatus(userId) {
            const user = users.find(u => u.id === userId);
            if (user) {
                user.active = !user.active;
                localStorage.setItem('volante_users', JSON.stringify(users));
                loadUsersList();
            }
        }

        function deleteUser(userId) {
            if (confirm('Tem certeza que deseja excluir este usuário?')) {
                users = users.filter(u => u.id !== userId);
                localStorage.setItem('volante_users', JSON.stringify(users));
                loadUsersList();
                alert('Usuário excluído com sucesso!');
            }
        }

        // Funções administrativas adicionais
        function handleGeneratePassword(e) {
            e.preventDefault();
            const userId = document.getElementById('userSelectPassword').value;
            
            if (!userId) {
                alert('Selecione um usuário!');
                return;
            }

            const user = users.find(u => u.id == userId);
            if (user) {
                const newPassword = generateRandomPassword();
                user.password = newPassword;
                localStorage.setItem('volante_users', JSON.stringify(users));
                
                // Mostrar opções para o administrador
                const sendWhatsApp = confirm(`Nova senha gerada para ${user.name}: ${newPassword}\n\nDeseja enviar esta senha via WhatsApp?`);
                
                if (sendWhatsApp && user.whatsapp) {
                    const message = `Olá ${user.name}! Sua nova senha do Volante Financeiro é: ${newPassword}\n\nGuarde esta senha em local seguro.`;
                    const whatsappUrl = `https://wa.me/55${user.whatsapp.replace(/\D/g, '')}?text=${encodeURIComponent(message)}`;
                    window.open(whatsappUrl, '_blank');
                    alert('Senha gerada e enviada via WhatsApp!');
                } else if (sendWhatsApp && !user.whatsapp) {
                    alert('WhatsApp não cadastrado para este usuário!');
                } else {
                    alert('Nova senha gerada com sucesso!');
                }
                
                document.getElementById('generatePasswordForm').reset();
                updateUserSelectOptions();
            }
        }

        function generateRandomPassword() {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
            let password = '';
            for (let i = 0; i < 8; i++) {
                password += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return password;
        }

        function updateUserSelectOptions() {
            const select = document.getElementById('userSelectPassword');
            select.innerHTML = '<option value="">Selecione um usuário...</option>';
            
            users.forEach(user => {
                const option = document.createElement('option');
                option.value = user.id;
                option.textContent = `${user.name} - ${user.cpf}`;
                select.appendChild(option);
            });
        }

        function sendWhatsAppNotification(userId) {
            const user = users.find(u => u.id === userId);
            if (user && user.whatsapp) {
                const message = `Olá ${user.name}! Você tem atualizações no Volante Financeiro. Acesse o app para mais informações.`;
                const whatsappUrl = `https://wa.me/55${user.whatsapp.replace(/\D/g, '')}?text=${encodeURIComponent(message)}`;
                window.open(whatsappUrl, '_blank');
            } else {
                alert('WhatsApp não cadastrado para este usuário!');
            }
        }

        // Funções de upload de imagem
        function handleAppLogoUpload(e) {
            const file = e.target.files[0];
            if (file) {
                if (file.size > 2 * 1024 * 1024) {
                    alert('Arquivo muito grande! Máximo 2MB.');
                    return;
                }

                const reader = new FileReader();
                reader.onload = function(event) {
                    const imageUrl = event.target.result;
                    
                    // Atualizar preview no admin
                    const adminPreview = document.getElementById('adminAppLogoPreview');
                    adminPreview.innerHTML = `<img src="${imageUrl}" alt="Logo" class="w-full h-full object-cover rounded-full">`;
                    
                    // Atualizar logo no dashboard principal
                    const appLogo = document.getElementById('appLogoDisplay');
                    if (appLogo) {
                        appLogo.innerHTML = `<img src="${imageUrl}" alt="Logo" class="w-full h-full object-cover rounded-full">`;
                    }
                    
                    // Salvar no localStorage
                    localStorage.setItem('volante_app_logo', imageUrl);
                    
                    alert('Logo do aplicativo atualizada com sucesso!');
                };
                reader.readAsDataURL(file);
            }
        }

        let tempDevLogo = null;

        function handleDevLogoUpload(e) {
            const file = e.target.files[0];
            if (file) {
                // Verificar tipo de arquivo
                if (!file.type.match(/^image\/(png|jpeg)$/)) {
                    alert('Formato não suportado! Use apenas PNG ou JPEG.');
                    return;
                }

                if (file.size > 2 * 1024 * 1024) {
                    alert('Arquivo muito grande! Máximo 2MB.');
                    return;
                }

                const reader = new FileReader();
                reader.onload = function(event) {
                    tempDevLogo = event.target.result;
                    
                    // Mostrar preview
                    const preview = document.getElementById('devLogoPreview');
                    preview.innerHTML = `<img src="${tempDevLogo}" alt="Logo Preview" class="w-full h-full object-cover rounded-lg">`;
                    
                    // Habilitar botão salvar
                    document.getElementById('saveDevLogoBtn').disabled = false;
                };
                reader.readAsDataURL(file);
            }
        }

        function saveDevLogo() {
            if (tempDevLogo) {
                localStorage.setItem('volante_dev_logo', tempDevLogo);
                alert('Logo do desenvolvedor salva com sucesso!');
                
                // Desabilitar botão salvar
                document.getElementById('saveDevLogoBtn').disabled = true;
                tempDevLogo = null;
            }
        }

        // Funções de edição e exclusão
        function editEarning(id) {
            const earning = earnings.find(e => e.id === id);
            if (earning) {
                document.getElementById('earningPlatform').value = earning.platform;
                document.getElementById('earningAmount').value = earning.amount;
                document.getElementById('earningDate').value = earning.date;
                document.getElementById('earningType').value = earning.type;
                
                // Remover o ganho original
                earnings = earnings.filter(e => e.id !== id);
                localStorage.setItem('volante_earnings', JSON.stringify(earnings));
                updateEarningsList();
                
                alert('Ganho carregado para edição. Faça as alterações e clique em "Adicionar Ganho".');
            }
        }

        function deleteEarning(id) {
            if (confirm('Tem certeza que deseja excluir este ganho?')) {
                earnings = earnings.filter(e => e.id !== id);
                localStorage.setItem('volante_earnings', JSON.stringify(earnings));
                updateEarningsList();
                alert('Ganho excluído com sucesso!');
            }
        }

        function editExpense(id) {
            const expense = expenses.find(e => e.id === id);
            if (expense) {
                document.getElementById('expenseCategory').value = expense.category;
                document.getElementById('expenseAmount').value = expense.amount;
                document.getElementById('expenseDate').value = expense.date;
                document.getElementById('expenseDescription').value = expense.description;
                
                // Remover a despesa original
                expenses = expenses.filter(e => e.id !== id);
                localStorage.setItem('volante_expenses', JSON.stringify(expenses));
                updateExpensesList();
                
                alert('Despesa carregada para edição. Faça as alterações e clique em "Adicionar Despesa".');
            }
        }

        function deleteExpense(id) {
            if (confirm('Tem certeza que deseja excluir esta despesa?')) {
                expenses = expenses.filter(e => e.id !== id);
                localStorage.setItem('volante_expenses', JSON.stringify(expenses));
                updateExpensesList();
                alert('Despesa excluída com sucesso!');
            }
        }

        // Função para editar informações sobre
        function handleEditAbout(e) {
            e.preventDefault();
            
            const aboutInfo = {
                projectDescription: document.getElementById('projectDescription').value,
                devTeam: document.getElementById('devTeam').value,
                teachers: document.getElementById('teachers').value,
                schoolName: document.getElementById('schoolName').value,
                systemVersion: document.getElementById('systemVersion').value
            };
            
            localStorage.setItem('volante_about_info', JSON.stringify(aboutInfo));
            updateAboutTab();
            alert('Informações da aba Sobre atualizadas com sucesso!');
        }

        // Função para atualizar a aba sobre com as informações editadas
        function updateAboutTab() {
            const savedInfo = JSON.parse(localStorage.getItem('volante_about_info') || '{}');
            
            if (Object.keys(savedInfo).length > 0) {
                // Atualizar o conteúdo da aba sobre
                const aboutContent = document.querySelector('#aboutTab .space-y-6');
                if (aboutContent) {
                    aboutContent.innerHTML = `
                        <div>
                            <h3 class="text-lg font-semibold text-gray-800 mb-3">Sobre o Projeto</h3>
                            <p class="text-gray-600 leading-relaxed">
                                ${savedInfo.projectDescription || 'O Volante Financeiro é um aplicativo desenvolvido especialmente para motoristas de aplicativo e profissionais do transporte em Corumbá-MS e Ladário-MS. O sistema permite organizar despesas pessoais e operacionais, planejar ganhos, monitorar custos e otimizar a rentabilidade, adaptando-se à realidade local da região.'}
                            </p>
                        </div>

                        <div>
                            <h3 class="text-lg font-semibold text-gray-800 mb-3">Desenvolvedores</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div class="bg-gray-50 p-4 rounded-lg">
                                    <h4 class="font-semibold text-green-700 mb-2">Equipe de Desenvolvimento</h4>
                                    <div class="text-sm text-gray-600 space-y-1">
                                        ${savedInfo.devTeam ? savedInfo.devTeam.split('\n').map(member => `<div>${member}</div>`).join('') : '<div>• João Victor Ribeiro de Souza</div><div>• Odilon Chalis</div><div>• Thaviny Maria Moraes de Toledo Soares</div><div>• Wallace Kauã Samosa Coronel</div>'}
                                    </div>
                                </div>
                                <div class="bg-gray-50 p-4 rounded-lg">
                                    <h4 class="font-semibold text-green-700 mb-2">Professores Responsáveis</h4>
                                    <div class="text-sm text-gray-600 space-y-1">
                                        ${savedInfo.teachers ? savedInfo.teachers.split('\n').map(teacher => `<div>${teacher}</div>`).join('') : '<div>• Gabriela Luiza da Costa Neves</div><div>• Wellington Cesar de Oliveira</div>'}
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div>
                            <h3 class="text-lg font-semibold text-gray-800 mb-3">Funcionalidades</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <ul class="text-sm text-gray-600 space-y-2">
                                    <li class="flex items-center">
                                        <span class="w-2 h-2 bg-green-500 rounded-full mr-3"></span>
                                        Controle de ganhos por corrida/entrega
                                    </li>
                                    <li class="flex items-center">
                                        <span class="w-2 h-2 bg-green-500 rounded-full mr-3"></span>
                                        Gestão de despesas operacionais
                                    </li>
                                    <li class="flex items-center">
                                        <span class="w-2 h-2 bg-green-500 rounded-full mr-3"></span>
                                        Sistema de reservas financeiras
                                    </li>
                                    <li class="flex items-center">
                                        <span class="w-2 h-2 bg-green-500 rounded-full mr-3"></span>
                                        Análises e relatórios detalhados
                                    </li>
                                </ul>
                                <ul class="text-sm text-gray-600 space-y-2">
                                    <li class="flex items-center">
                                        <span class="w-2 h-2 bg-green-500 rounded-full mr-3"></span>
                                        Suporte a múltiplas plataformas
                                    </li>
                                    <li class="flex items-center">
                                        <span class="w-2 h-2 bg-green-500 rounded-full mr-3"></span>
                                        Interface responsiva e intuitiva
                                    </li>
                                    <li class="flex items-center">
                                        <span class="w-2 h-2 bg-green-500 rounded-full mr-3"></span>
                                        Painel administrativo completo
                                    </li>
                                    <li class="flex items-center">
                                        <span class="w-2 h-2 bg-green-500 rounded-full mr-3"></span>
                                        Notificações via WhatsApp
                                    </li>
                                </ul>
                            </div>
                        </div>

                        <div class="text-center pt-6 border-t">
                            <p class="text-sm text-gray-500">
                                ${savedInfo.systemVersion || 'Versão 1.0 - 2024'} | Desenvolvido com ❤️ para a comunidade de motoristas
                            </p>
                        </div>
                    `;
                }
                
                // Atualizar rodapé
                const footer = document.querySelector('footer p');
                if (footer) {
                    footer.innerHTML = `Desenvolvido por <strong>${savedInfo.schoolName || 'Escola Estadual Dr. João Leite de Barros'}</strong>`;
                }
            }
        }

        // Carregar informações editadas da aba sobre
        function loadAboutInfo() {
            const savedInfo = JSON.parse(localStorage.getItem('volante_about_info') || '{}');
            
            if (Object.keys(savedInfo).length > 0) {
                document.getElementById('projectDescription').value = savedInfo.projectDescription || '';
                document.getElementById('devTeam').value = savedInfo.devTeam || '';
                document.getElementById('teachers').value = savedInfo.teachers || '';
                document.getElementById('schoolName').value = savedInfo.schoolName || '';
                document.getElementById('systemVersion').value = savedInfo.systemVersion || '';
            }
        }

        // Funções de apoiadores
        function loadSupportersList() {
            const list = document.getElementById('supportersList');
            
            if (supporters.length === 0) {
                list.innerHTML = `
                    <div class="col-span-full text-center py-12">
                        <div class="text-gray-400 mb-4">
                            <svg class="w-16 h-16 mx-auto" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                            </svg>
                        </div>
                        <h3 class="text-lg font-semibold text-gray-600 mb-2">Ainda não temos apoiadores</h3>
                        <p class="text-gray-500">Seja o primeiro a apoiar nosso projeto!</p>
                    </div>
                `;
                return;
            }

            // Agrupar por tipo de apoio
            const groupedSupporters = supporters.reduce((groups, supporter) => {
                const type = supporter.type || 'Apoiador';
                if (!groups[type]) groups[type] = [];
                groups[type].push(supporter);
                return groups;
            }, {});

            // Ordem de prioridade dos tipos
            const typeOrder = ['Patrocinador Principal', 'Patrocinador', 'Parceiro', 'Apoiador'];
            
            let html = '';
            typeOrder.forEach(type => {
                if (groupedSupporters[type]) {
                    html += `
                        <div class="col-span-full mb-6">
                            <h3 class="text-lg font-semibold text-green-800 mb-4 text-center">${type}${groupedSupporters[type].length > 1 ? 's' : ''}</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                ${groupedSupporters[type].map(supporter => `
                                    <div class="bg-white border rounded-lg p-6 text-center hover:shadow-lg transition-shadow">
                                        ${supporter.logo ? 
                                            `<img src="${supporter.logo}" alt="${supporter.name}" class="w-20 h-20 mx-auto mb-4 object-contain rounded-lg">` :
                                            `<div class="w-20 h-20 mx-auto mb-4 bg-green-100 rounded-lg flex items-center justify-center">
                                                <span class="text-green-600 font-bold text-xl">${supporter.name.charAt(0)}</span>
                                            </div>`
                                        }
                                        <h4 class="font-semibold text-gray-800 mb-2">${supporter.name}</h4>
                                        ${supporter.description ? `<p class="text-sm text-gray-600 mb-3">${supporter.description}</p>` : ''}
                                        <div class="flex justify-center space-x-2">
                                            ${supporter.website ? 
                                                `<a href="${supporter.website}" target="_blank" class="text-green-600 hover:text-green-800 text-sm">
                                                    🌐 Website
                                                </a>` : ''
                                            }
                                            ${supporter.phone ? 
                                                `<a href="tel:${supporter.phone}" class="text-green-600 hover:text-green-800 text-sm">
                                                    📞 Contato
                                                </a>` : ''
                                            }
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    `;
                }
            });

            list.innerHTML = html;
        }

        function loadAdminSupportersList() {
            const list = document.getElementById('adminSupportersList');
            
            if (supporters.length === 0) {
                list.innerHTML = '<p class="text-gray-500">Nenhum apoiador cadastrado.</p>';
                return;
            }

            list.innerHTML = supporters.map(supporter => `
                <div class="flex items-center justify-between p-4 border rounded-lg bg-white">
                    <div class="flex items-center space-x-4">
                        ${supporter.logo ? 
                            `<img src="${supporter.logo}" alt="${supporter.name}" class="w-12 h-12 object-contain rounded">` :
                            `<div class="w-12 h-12 bg-green-100 rounded flex items-center justify-center">
                                <span class="text-green-600 font-bold">${supporter.name.charAt(0)}</span>
                            </div>`
                        }
                        <div>
                            <h4 class="font-semibold">${supporter.name}</h4>
                            <p class="text-sm text-gray-600">${supporter.type}</p>
                            ${supporter.description ? `<p class="text-xs text-gray-500">${supporter.description.substring(0, 50)}${supporter.description.length > 50 ? '...' : ''}</p>` : ''}
                        </div>
                    </div>
                    <div class="flex space-x-2">
                        <button onclick="editSupporter(${supporter.id})" 
                                class="px-3 py-1 bg-blue-500 text-white rounded text-sm hover:bg-blue-600">
                            Editar
                        </button>
                        <button onclick="deleteSupporter(${supporter.id})" 
                                class="px-3 py-1 bg-red-500 text-white rounded text-sm hover:bg-red-600">
                            Excluir
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function showAddSupporterForm() {
            document.getElementById('addSupporterModal').classList.remove('hidden');
        }

        function hideAddSupporterForm() {
            document.getElementById('addSupporterModal').classList.add('hidden');
            document.getElementById('addSupporterForm').reset();
        }

        function handleAddSupporter(e) {
            e.preventDefault();
            
            const logoFile = document.getElementById('supporterLogo').files[0];
            
            if (logoFile) {
                if (logoFile.size > 2 * 1024 * 1024) {
                    alert('Logo muito grande! Máximo 2MB.');
                    return;
                }

                const reader = new FileReader();
                reader.onload = function(event) {
                    saveSupporterData(event.target.result);
                };
                reader.readAsDataURL(logoFile);
            } else {
                saveSupporterData(null);
            }
        }

        function saveSupporterData(logoData) {
            const newSupporter = {
                id: Date.now(),
                name: document.getElementById('supporterName').value,
                description: document.getElementById('supporterDescription').value,
                website: document.getElementById('supporterWebsite').value,
                phone: document.getElementById('supporterPhone').value,
                logo: logoData,
                type: document.getElementById('supporterType').value
            };

            supporters.push(newSupporter);
            localStorage.setItem('volante_supporters', JSON.stringify(supporters));
            
            hideAddSupporterForm();
            loadAdminSupportersList();
            loadSupportersList();
            alert('Apoiador adicionado com sucesso!');
        }

        function editSupporter(id) {
            const supporter = supporters.find(s => s.id === id);
            if (supporter) {
                document.getElementById('supporterName').value = supporter.name;
                document.getElementById('supporterDescription').value = supporter.description || '';
                document.getElementById('supporterWebsite').value = supporter.website || '';
                document.getElementById('supporterPhone').value = supporter.phone || '';
                document.getElementById('supporterType').value = supporter.type;
                
                // Remover o apoiador original para permitir edição
                supporters = supporters.filter(s => s.id !== id);
                localStorage.setItem('volante_supporters', JSON.stringify(supporters));
                
                showAddSupporterForm();
                alert('Apoiador carregado para edição. Faça as alterações e clique em "Adicionar".');
            }
        }

        function deleteSupporter(id) {
            if (confirm('Tem certeza que deseja excluir este apoiador?')) {
                supporters = supporters.filter(s => s.id !== id);
                localStorage.setItem('volante_supporters', JSON.stringify(supporters));
                loadAdminSupportersList();
                loadSupportersList();
                alert('Apoiador excluído com sucesso!');
            }
        }

        function contactSupport() {
            const message = 'Olá! Gostaria de saber mais sobre como apoiar o projeto Volante Financeiro.';
            const whatsappUrl = `https://wa.me/5567999999999?text=${encodeURIComponent(message)}`;
            window.open(whatsappUrl, '_blank');
        }

        // Carregar logos salvos
        function loadSavedLogos() {
            const appLogo = localStorage.getItem('volante_app_logo');
            if (appLogo) {
                const adminPreview = document.getElementById('adminAppLogoPreview');
                const appDisplay = document.getElementById('appLogoDisplay');
                
                if (adminPreview) {
                    adminPreview.innerHTML = `<img src="${appLogo}" alt="Logo" class="w-full h-full object-cover rounded-full">`;
                }
                if (appDisplay) {
                    appDisplay.innerHTML = `<img src="${appLogo}" alt="Logo" class="w-full h-full object-cover rounded-full">`;
                }
            }

            const devLogo = localStorage.getItem('volante_dev_logo');
            if (devLogo) {
                const devPreview = document.getElementById('devLogoPreview');
                if (devPreview) {
                    devPreview.innerHTML = `<img src="${devLogo}" alt="Logo Desenvolvedor" class="w-full h-full object-cover rounded-lg">`;
                }
            }
        }

        // Carregar configurações de contato
        function loadContactSettings() {
            const contactSettings = JSON.parse(localStorage.getItem('volante_contact_settings') || '{}');
            
            if (contactSettings.email) {
                const emailField = document.getElementById('contactEmail');
                if (emailField) emailField.value = contactSettings.email;
            }
            
            if (contactSettings.whatsapp) {
                const whatsappField = document.getElementById('contactWhatsapp');
                if (whatsappField) whatsappField.value = contactSettings.whatsapp;
            }
            
            if (contactSettings.supporterMessage) {
                const messageField = document.getElementById('supporterMessage');
                if (messageField) messageField.value = contactSettings.supporterMessage;
            }
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9755933991785444',t:'MTc1NjIzNDg1OC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
