<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Volante Financeiro - Sistema de Gest√£o Financeira</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .app-logo {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #22c55e, #16a34a);
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            color: white;
            position: relative;
            overflow: hidden;
        }

        .volante-logo {
            width: 50px;
            height: 50px;
            border: 4px solid white;
            border-radius: 50%;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            animation: rotate 3s linear infinite;
        }

        .volante-logo::before {
            content: '';
            position: absolute;
            width: 20px;
            height: 4px;
            background: white;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        .volante-logo::after {
            content: '';
            position: absolute;
            width: 4px;
            height: 20px;
            background: white;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        .dollar-center {
            position: absolute;
            font-size: 1.2rem;
            font-weight: bold;
            color: #22c55e;
            background: white;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2;
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .header-text h1 {
            font-size: 2.5rem;
            margin-bottom: 5px;
        }
        
        .header-text h1 .volante {
            color: #2563eb;
        }
        
        .header-text h1 .financeiro {
            color: #16a34a;
        }

        .header-text p {
            color: #22c55e;
            font-size: 1.1rem;
            font-weight: 600;
        }

        .dev-logo {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #374151, #1f2937);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
            color: #16a34a;
            font-weight: 600;
        }

        .logout-btn {
            background: #ef4444;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
        }

        .nav-tabs {
            display: flex;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            padding: 10px;
            margin-bottom: 30px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            overflow-x: auto;
            flex-wrap: wrap;
        }

        .nav-tab {
            flex: 1;
            padding: 15px 20px;
            background: transparent;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            color: #374151;
            transition: all 0.3s ease;
            white-space: nowrap;
            min-width: 120px;
            margin: 2px;
        }

        .nav-tab.active {
            background: linear-gradient(135deg, #22c55e, #16a34a);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(34, 197, 94, 0.4);
        }

        .tab-content {
            display: none;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .tab-content.active {
            display: block;
        }

        .login-container {
            max-width: 400px;
            margin: 50px auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            text-align: center;
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .card {
            background: linear-gradient(135deg, #f7fafc, #edf2f7);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
        }

        .card-icon {
            font-size: 3rem;
            margin-bottom: 15px;
        }

        .card-title {
            font-size: 1.1rem;
            color: #4a5568;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .card-value {
            font-size: 2rem;
            font-weight: bold;
            color: #2d3748;
        }

        .form-group {
            margin-bottom: 20px;
            text-align: left;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #4a5568;
        }

        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            outline: none;
            border-color: #22c55e;
            box-shadow: 0 0 0 3px rgba(34, 197, 94, 0.1);
        }

        .btn {
            background: linear-gradient(135deg, #22c55e, #16a34a);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(34, 197, 94, 0.4);
        }

        .btn-danger {
            background: linear-gradient(135deg, #e53e3e, #c53030);
        }

        .btn-danger:hover {
            box-shadow: 0 4px 15px rgba(229, 62, 62, 0.4);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #6b7280, #4b5563);
        }

        .transaction-list {
            max-height: 400px;
            overflow-y: auto;
            margin-top: 20px;
        }

        .transaction-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: #f7fafc;
            border-radius: 10px;
            margin-bottom: 10px;
            border-left: 4px solid #22c55e;
        }

        .transaction-item.expense {
            border-left-color: #e53e3e;
        }

        .transaction-info {
            flex: 1;
        }

        .transaction-description {
            font-weight: 600;
            color: #2d3748;
        }

        .transaction-category {
            font-size: 0.9rem;
            color: #718096;
        }

        .transaction-value {
            font-weight: bold;
            font-size: 1.1rem;
        }

        .transaction-value.positive {
            color: #16a34a;
        }

        .transaction-value.negative {
            color: #e53e3e;
        }

        .chart-container {
            position: relative;
            height: 300px;
            margin: 20px 0;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .alert {
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            font-weight: 600;
        }

        .alert-success {
            background: #d1fae5;
            color: #065f46;
            border: 1px solid #a7f3d0;
        }

        .alert-warning {
            background: #fefcbf;
            color: #744210;
            border: 1px solid #f6e05e;
        }

        .alert-danger {
            background: #fed7d7;
            color: #742a2a;
            border: 1px solid #fc8181;
        }

        .admin-panel {
            background: linear-gradient(135deg, #1f2937, #374151);
            color: white;
        }

        .admin-panel .card {
            background: linear-gradient(135deg, #374151, #4b5563);
            color: white;
        }

        .user-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .user-table th, .user-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e2e8f0;
        }

        .user-table th {
            background: #f8fafc;
            font-weight: 600;
        }

        .apoiadores-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .apoiador-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            text-align: center;
        }

        .apoiador-logo {
            width: 80px;
            height: 80px;
            background: #f3f4f6;
            border-radius: 10px;
            margin: 0 auto 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
        }

        .hidden {
            display: none !important;
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes slideOut {
            from {
                transform: translateX(0);
                opacity: 1;
            }
            to {
                transform: translateX(100%);
                opacity: 0;
            }
        }

        .footer {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 15px;
            margin-top: 30px;
            text-align: center;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            color: #6b7280;
            font-size: 0.9rem;
        }

        .footer a {
            color: #2563eb;
            text-decoration: none;
            font-weight: 600;
        }

        .footer a:hover {
            text-decoration: underline;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }

            .header {
                flex-direction: column;
                gap: 15px;
            }

            .header h1 {
                font-size: 2rem;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .nav-tabs {
                flex-direction: column;
            }

            .nav-tab {
                min-width: auto;
            }
        }
    </style>
</head>
<body>
    <!-- Tela de Login -->
    <div id="login-screen" class="login-container">
        <div class="logo-container" style="justify-content: center; margin-bottom: 30px;">
            <div class="app-logo">
                <div class="volante-logo">
                    <div class="dollar-center">$</div>
                </div>
            </div>
            <div class="header-text">
                <h1 style="font-size: 2rem;"><span class="volante">Volante</span> <span class="financeiro">Financeiro</span></h1>
                <p>Sistema de Gest√£o Financeira</p>
            </div>
        </div>

        <form id="login-form">
            <div class="form-group">
                <label>CPF</label>
                <input type="text" id="login-cpf" placeholder="000.000.000-00" required>
                <div id="cpf-status" style="margin-top: 5px; font-size: 0.9rem; font-weight: 600;"></div>
            </div>
            <div class="form-group">
                <label>Senha</label>
                <input type="password" id="login-senha" required>
            </div>
            <button type="submit" class="btn" style="width: 100%; margin-bottom: 15px;">üîê Entrar</button>
            <button type="button" class="btn btn-secondary" style="width: 100%; margin-bottom: 15px;" onclick="showCadastro()">üë§ Criar Conta</button>
            <button type="button" class="btn" style="width: 100%; background: linear-gradient(135deg, #374151, #1f2937);" onclick="showAdminLogin()">‚öôÔ∏è Acesso Administrador</button>
        </form>
    </div>

    <!-- Tela de Login Administrativo -->
    <div id="admin-login-screen" class="login-container hidden">
        <div class="logo-container" style="justify-content: center; margin-bottom: 30px;">
            <div class="app-logo">‚öôÔ∏è</div>
            <div class="header-text">
                <h1 style="font-size: 2rem; color: #374151;">Acesso Administrativo</h1>
                <p style="color: #6b7280;">Volante Financeiro</p>
            </div>
        </div>

        <form id="admin-login-form">
            <div class="form-group">
                <label>Login</label>
                <input type="text" id="admin-login-user" placeholder="Digite seu login" required>
            </div>
            <div class="form-group">
                <label>Senha</label>
                <input type="password" id="admin-login-senha" required>
            </div>
            <button type="submit" class="btn" style="width: 100%; margin-bottom: 15px; background: linear-gradient(135deg, #374151, #1f2937);">üîê Entrar como Admin</button>
            <button type="button" class="btn btn-secondary" style="width: 100%;" onclick="showLogin()">üîô Voltar ao Login</button>
        </form>
    </div>

    <!-- Tela de Cadastro -->
    <div id="cadastro-screen" class="login-container hidden">
        <div class="logo-container" style="justify-content: center; margin-bottom: 30px;">
            <div class="app-logo">
                <div class="volante-logo">
                    <div class="dollar-center">$</div>
                </div>
            </div>
            <div class="header-text">
                <h1 style="font-size: 2rem;">Criar Conta</h1>
                <p>Cadastre-se no <span class="volante">Volante</span> <span class="financeiro">Financeiro</span></p>
            </div>
        </div>

        <form id="cadastro-form">
            <div class="form-group">
                <label>Nome Completo</label>
                <input type="text" id="cadastro-nome" required>
            </div>
            <div class="form-group">
                <label>CPF</label>
                <input type="text" id="cadastro-cpf" placeholder="000.000.000-00" required>
            </div>
            <div class="form-group">
                <label>E-mail</label>
                <input type="email" id="cadastro-email" required>
            </div>
            <div class="form-group">
                <label>WhatsApp</label>
                <input type="text" id="cadastro-whatsapp" placeholder="(67) 99999-9999" required>
            </div>
            <div class="form-group">
                <label>Criar Senha</label>
                <input type="password" id="cadastro-senha" required>
            </div>
            <div class="form-group">
                <label>Confirmar Senha</label>
                <input type="password" id="cadastro-confirma-senha" required>
            </div>
            <button type="submit" class="btn" style="width: 100%; margin-bottom: 15px;">‚úÖ Criar Conta</button>
            <button type="button" class="btn btn-secondary" style="width: 100%;" onclick="showLogin()">üîô Voltar ao Login</button>
        </form>
    </div>

    <!-- Aplicativo Principal -->
    <div id="main-app" class="container hidden">
        <div class="header">
            <div class="logo-container">
                <div class="app-logo">
                    <div class="volante-logo">
                        <div class="dollar-center">$</div>
                    </div>
                </div>
                <div class="header-text">
                    <h1><span class="volante">Volante</span> <span class="financeiro">Financeiro</span></h1>
                    <p>Sistema de Gest√£o Financeira para Motoristas</p>
                </div>
            </div>
            <div class="user-info">
                <span id="user-name">Usu√°rio</span>
                <button class="logout-btn" onclick="logout()">Sair</button>
            </div>
            <div class="dev-logo">JLB</div>
        </div>

        <div class="nav-tabs" id="main-nav">
            <button class="nav-tab active" onclick="showTab('dashboard')">üìä Dashboard</button>
            <button class="nav-tab" onclick="showTab('receitas')">üí∞ Receitas</button>
            <button class="nav-tab" onclick="showTab('despesas')">üí∏ Despesas</button>
            <button class="nav-tab" onclick="showTab('planejamento')">üéØ Metas</button>
            <button class="nav-tab" onclick="showTab('relatorios')">üìà Relat√≥rios</button>
            <button class="nav-tab" onclick="showTab('apoiadores')">ü§ù Apoiadores</button>
            <button class="nav-tab" onclick="showTab('sobre')">‚ÑπÔ∏è Sobre</button>
        </div>

        <!-- Dashboard Tab -->
        <div id="dashboard" class="tab-content active">
            <div id="alerts-container"></div>
            
            <div class="dashboard-grid">
                <div class="card">
                    <div class="card-icon">üí∞</div>
                    <div class="card-title">Receita do M√™s</div>
                    <div class="card-value" id="receita-mes">R$ 0,00</div>
                </div>
                <div class="card">
                    <div class="card-icon">üí∏</div>
                    <div class="card-title">Despesas do M√™s</div>
                    <div class="card-value" id="despesas-mes">R$ 0,00</div>
                </div>
                <div class="card">
                    <div class="card-icon">üìä</div>
                    <div class="card-title">Lucro L√≠quido</div>
                    <div class="card-value" id="lucro-mes">R$ 0,00</div>
                </div>
                <div class="card">
                    <div class="card-icon">üéØ</div>
                    <div class="card-title">Meta do M√™s</div>
                    <div class="card-value" id="meta-mes">R$ 0,00</div>
                </div>
            </div>

            <div class="chart-container">
                <canvas id="dashboardChart"></canvas>
            </div>

            <h3>üìã √öltimas Transa√ß√µes</h3>
            <div class="transaction-list" id="recent-transactions"></div>
        </div>

        <!-- Footer -->
        <div class="footer">
            <p>Desenvolvido por <a href="#" onclick="alert('Escola Estadual Dr. Jo√£o Leite de Barros\\nCorumb√° - MS\\n\\nSistema desenvolvido pelos alunos do curso t√©cnico.')">Escola Estadual Dr. Jo√£o Leite de Barros</a></p>
        </div>

        <!-- Receitas Tab -->
        <div id="receitas" class="tab-content">
            <h2>üí∞ Controle de Receitas</h2>
            
            <form id="receita-form">
                <div class="form-row">
                    <div class="form-group">
                        <label>Plataforma</label>
                        <select id="receita-app" required>
                            <option value="">Selecione a plataforma</option>
                            <option value="BR Car">BR Car</option>
                            <option value="I Boltt">I Boltt</option>
                            <option value="iFood">iFood</option>
                            <option value="InDriver">InDriver</option>
                            <option value="Taxi-Connect">Taxi-Connect</option>
                            <option value="T√¥ Aqui!">T√¥ Aqui!</option>
                            <option value="Uber">Uber</option>
                            <option value="Urban">Urban</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Valor (R$)</label>
                        <input type="number" id="receita-valor" step="0.01" required>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Data</label>
                        <input type="date" id="receita-data" required>
                    </div>
                    <div class="form-group">
                        <label>N√∫mero de Corridas/Entregas</label>
                        <input type="number" id="receita-corridas" min="1" required>
                    </div>
                </div>

                <div class="form-group">
                    <label>Observa√ß√µes</label>
                    <input type="text" id="receita-obs" placeholder="Ex: Regi√£o centro, pico noturno...">
                </div>

                <button type="submit" class="btn">‚ûï Adicionar Receita</button>
            </form>

            <div class="transaction-list" id="receitas-list"></div>
        </div>

        <!-- Despesas Tab -->
        <div id="despesas" class="tab-content">
            <h2>üí∏ Controle de Despesas</h2>
            
            <form id="despesa-form">
                <div class="form-row">
                    <div class="form-group">
                        <label>Categoria</label>
                        <select id="despesa-categoria" required>
                            <option value="">Selecione a categoria</option>
                            <optgroup label="Despesas Operacionais">
                                <option value="Combust√≠vel">‚õΩ Combust√≠vel</option>
                                <option value="Manuten√ß√£o">üîß Manuten√ß√£o</option>
                                <option value="Seguro">üõ°Ô∏è Seguro</option>
                                <option value="IPVA">üìã IPVA</option>
                                <option value="Licenciamento">üìÑ Licenciamento</option>
                                <option value="Lavagem">üßΩ Lavagem</option>
                            </optgroup>
                            <optgroup label="Despesas Pessoais">
                                <option value="Alimenta√ß√£o">üçΩÔ∏è Alimenta√ß√£o</option>
                                <option value="Moradia">üè† Moradia</option>
                                <option value="Lazer">üéÆ Lazer</option>
                                <option value="Sa√∫de">üè• Sa√∫de</option>
                                <option value="Outros">üì¶ Outros</option>
                            </optgroup>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Valor (R$)</label>
                        <input type="number" id="despesa-valor" step="0.01" required>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Data</label>
                        <input type="date" id="despesa-data" required>
                    </div>
                    <div class="form-group">
                        <label>Descri√ß√£o</label>
                        <input type="text" id="despesa-descricao" placeholder="Ex: Abastecimento posto Shell" required>
                    </div>
                </div>

                <button type="submit" class="btn">‚ûï Adicionar Despesa</button>
            </form>

            <div class="transaction-list" id="despesas-list"></div>
        </div>

        <!-- Planejamento Tab -->
        <div id="planejamento" class="tab-content">
            <h2>üéØ Planejamento e Metas</h2>
            
            <form id="meta-form">
                <div class="form-row">
                    <div class="form-group">
                        <label>Meta de Lucro Mensal (R$)</label>
                        <input type="number" id="meta-valor" step="0.01" required>
                    </div>
                    <div class="form-group">
                        <label>Limite de Gastos Di√°rios (R$)</label>
                        <input type="number" id="limite-diario" step="0.01" required>
                    </div>
                </div>

                <button type="submit" class="btn">üíæ Salvar Configura√ß√µes</button>
            </form>

            <div id="progresso-meta" style="margin-top: 30px;">
                <h3>üìä Progresso da Meta</h3>
                <div class="card">
                    <div class="card-title">Progresso do M√™s Atual</div>
                    <div style="background: #e2e8f0; border-radius: 10px; height: 20px; margin: 15px 0;">
                        <div id="progress-bar" style="background: linear-gradient(135deg, #22c55e, #16a34a); height: 100%; border-radius: 10px; width: 0%; transition: width 0.3s ease;"></div>
                    </div>
                    <div id="progress-text">0% da meta atingida</div>
                </div>
            </div>
        </div>

        <!-- Relat√≥rios Tab -->
        <div id="relatorios" class="tab-content">
            <h2>üìà Relat√≥rios e An√°lises</h2>
            
            <div class="form-row">
                <div class="form-group">
                    <label>Per√≠odo</label>
                    <select id="periodo-relatorio">
                        <option value="mes">M√™s Atual</option>
                        <option value="trimestre">√öltimos 3 Meses</option>
                        <option value="semestre">√öltimos 6 Meses</option>
                        <option value="ano">Ano Atual</option>
                    </select>
                </div>
                <div class="form-group">
                    <button class="btn" onclick="gerarRelatorio()">üìä Gerar Relat√≥rio</button>
                </div>
            </div>

            <div class="chart-container">
                <canvas id="reportChart"></canvas>
            </div>

            <div id="relatorio-resumo" style="margin-top: 20px;"></div>
        </div>

        <!-- Apoiadores Tab -->
        <div id="apoiadores" class="tab-content">
            <h2>ü§ù Apoiadores e Parceiros</h2>
            
            <div class="apoiadores-grid" id="apoiadores-list">
                <div class="apoiador-card">
                    <div class="apoiador-logo">üè¢</div>
                    <h3>Patrocinador Principal</h3>
                    <p><strong>Em breve...</strong></p>
                    <p>Seja nosso parceiro e apoie o desenvolvimento de solu√ß√µes para motoristas!</p>
                </div>
                
                <div class="apoiador-card">
                    <div class="apoiador-logo">üéì</div>
                    <h3>Institui√ß√£o de Ensino</h3>
                    <p><strong>IFMS - Campus Corumb√°</strong></p>
                    <p>Instituto Federal de Mato Grosso do Sul</p>
                </div>
                
                <div class="apoiador-card">
                    <div class="apoiador-logo">üíº</div>
                    <h3>Parceiros Comerciais</h3>
                    <p><strong>Oportunidade Aberta</strong></p>
                    <p>Entre em contato para ser nosso parceiro comercial!</p>
                </div>
            </div>
        </div>

        <!-- Sobre Tab -->
        <div id="sobre" class="tab-content">
            <h2>‚ÑπÔ∏è Sobre o Volante Financeiro</h2>
            
            <div class="card" style="text-align: left; margin-bottom: 20px;">
                <h3 style="color: #16a34a; margin-bottom: 15px;">üì± Sistema de Gest√£o Financeira para Motoristas</h3>
                
                <h4 style="margin-top: 25px; margin-bottom: 10px; color: #374151;">üéØ Sobre o Projeto</h4>
                <p style="line-height: 1.6; color: #4b5563;">
                    O Volante Financeiro √© um aplicativo desenvolvido especialmente para motoristas de aplicativo e profissionais do transporte em Corumb√°-MS e Lad√°rio-MS. O sistema permite organizar despesas pessoais e operacionais, planejar ganhos, monitorar custos e otimizar a rentabilidade, adaptando-se √† realidade local da regi√£o.
                </p>

                <h4 style="margin-top: 25px; margin-bottom: 10px; color: #374151;">üë• Equipe de Desenvolvimento</h4>
                <ul style="line-height: 1.8; color: #4b5563; margin-left: 20px;">
                    <li>Jo√£o Victor Ribeiro de Souza</li>
                    <li>Odilon Chalis</li>
                    <li>Thaviny Maria Moraes de Toledo Soares</li>
                    <li>Wallace Kau√£ Samosa Coronel</li>
                </ul>

                <h4 style="margin-top: 25px; margin-bottom: 10px; color: #374151;">üë®‚Äçüè´ Professores Respons√°veis</h4>
                <ul style="line-height: 1.8; color: #4b5563; margin-left: 20px;">
                    <li>Gabriela Luiza da Costa Neves</li>
                    <li>Wellington Cesar de Oliveira</li>
                </ul>

                <h4 style="margin-top: 25px; margin-bottom: 10px; color: #374151;">‚öôÔ∏è Funcionalidades</h4>
                <ul style="line-height: 1.8; color: #4b5563; margin-left: 20px;">
                    <li>Controle de ganhos por corrida/entrega</li>
                    <li>Gest√£o de despesas operacionais</li>
                    <li>Sistema de reservas financeiras</li>
                    <li>An√°lises e relat√≥rios detalhados</li>
                    <li>Suporte a m√∫ltiplas plataformas</li>
                    <li>Interface responsiva e intuitiva</li>
                    <li>Painel administrativo completo</li>
                    <li>Notifica√ß√µes via WhatsApp</li>
                </ul>

                <div style="text-align: center; margin-top: 30px; padding-top: 20px; border-top: 2px solid #e5e7eb;">
                    <p style="color: #16a34a; font-weight: 600;">
                        Vers√£o 1.0 - 2024 | Desenvolvido com ‚ù§Ô∏è para a comunidade de motoristas
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Painel Administrativo -->
    <div id="admin-panel" class="container admin-panel hidden">
        <div class="header">
            <div class="logo-container">
                <div class="app-logo">‚öôÔ∏è</div>
                <div class="header-text">
                    <h1 style="color: #374151;">Painel Administrativo</h1>
                    <p style="color: #6b7280;">Volante Financeiro</p>
                </div>
            </div>
            <div class="user-info">
                <span style="color: #374151;">Administrador</span>
                <button class="logout-btn" onclick="logout()">Sair</button>
            </div>
        </div>

        <div class="nav-tabs">
            <button class="nav-tab active" onclick="showAdminTab('admin-usuarios')">üë• Usu√°rios</button>
            <button class="nav-tab" onclick="showAdminTab('admin-administradores')">üë®‚Äçüíº Administradores</button>
            <button class="nav-tab" onclick="showAdminTab('admin-config')">‚öôÔ∏è Configura√ß√µes</button>
            <button class="nav-tab" onclick="showAdminTab('admin-apoiadores')">ü§ù Apoiadores</button>
            <button class="nav-tab" onclick="showAdminTab('admin-backup')">üíæ Backup & Logs</button>
            <button class="nav-tab" onclick="showAdminTab('admin-sobre')">üìù Editar Sobre</button>
        </div>

        <!-- Admin Usu√°rios -->
        <div id="admin-usuarios" class="tab-content active">
            <h2>üë• Gerenciar Usu√°rios</h2>
            
            <button class="btn" onclick="showNovoUsuario()" style="margin-bottom: 20px;">‚ûï Novo Usu√°rio</button>
            
            <div id="novo-usuario-form" class="hidden" style="background: #f8fafc; padding: 20px; border-radius: 10px; margin-bottom: 20px;">
                <h3>Cadastrar Novo Usu√°rio</h3>
                <form id="admin-usuario-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label>Nome Completo</label>
                            <input type="text" id="admin-nome" required>
                        </div>
                        <div class="form-group">
                            <label>CPF</label>
                            <input type="text" id="admin-cpf" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>E-mail</label>
                            <input type="email" id="admin-email" required>
                        </div>
                        <div class="form-group">
                            <label>WhatsApp</label>
                            <input type="text" id="admin-whatsapp" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Senha Inicial</label>
                        <input type="text" id="admin-senha" required>
                        <button type="button" class="btn btn-secondary" onclick="gerarSenha()" style="margin-top: 5px;">üé≤ Gerar Senha</button>
                    </div>
                    <button type="submit" class="btn">üíæ Salvar Usu√°rio</button>
                    <button type="button" class="btn btn-secondary" onclick="cancelarNovoUsuario()">‚ùå Cancelar</button>
                </form>
            </div>

            <table class="user-table">
                <thead>
                    <tr>
                        <th>Nome</th>
                        <th>CPF</th>
                        <th>E-mail</th>
                        <th>WhatsApp</th>
                        <th>Status</th>
                        <th>A√ß√µes</th>
                    </tr>
                </thead>
                <tbody id="usuarios-table">
                </tbody>
            </table>
        </div>

        <!-- Admin Administradores -->
        <div id="admin-administradores" class="tab-content">
            <h2>üë®‚Äçüíº Gerenciar Administradores</h2>
            
            <button class="btn" onclick="showNovoAdmin()" style="margin-bottom: 20px;">‚ûï Novo Administrador</button>
            
            <div id="novo-admin-form" class="hidden" style="background: #f8fafc; padding: 20px; border-radius: 10px; margin-bottom: 20px;">
                <h3>Cadastrar Novo Administrador</h3>
                <form id="admin-admin-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label>Nome Completo</label>
                            <input type="text" id="admin-admin-nome" required>
                        </div>
                        <div class="form-group">
                            <label>Login de Acesso</label>
                            <input type="text" id="admin-admin-login" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>E-mail</label>
                            <input type="email" id="admin-admin-email" required>
                        </div>
                        <div class="form-group">
                            <label>N√≠vel de Acesso</label>
                            <select id="admin-admin-nivel" required>
                                <option value="admin">Administrador</option>
                                <option value="super">Super Administrador</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Senha Inicial</label>
                        <input type="text" id="admin-admin-senha" required>
                        <button type="button" class="btn btn-secondary" onclick="gerarSenhaAdmin()" style="margin-top: 5px;">üé≤ Gerar Senha</button>
                    </div>
                    <button type="submit" class="btn">üíæ Salvar Administrador</button>
                    <button type="button" class="btn btn-secondary" onclick="cancelarNovoAdmin()">‚ùå Cancelar</button>
                </form>
            </div>

            <table class="user-table">
                <thead>
                    <tr>
                        <th>Nome</th>
                        <th>Login</th>
                        <th>E-mail</th>
                        <th>N√≠vel</th>
                        <th>Status</th>
                        <th>A√ß√µes</th>
                    </tr>
                </thead>
                <tbody id="admins-table">
                </tbody>
            </table>
        </div>

        <!-- Admin Configura√ß√µes -->
        <div id="admin-config" class="tab-content">
            <h2>‚öôÔ∏è Configura√ß√µes do Sistema</h2>
            
            <form id="config-form">
                <div class="form-group">
                    <label>Logo do Aplicativo</label>
                    <div style="display: flex; gap: 10px; align-items: center; margin-bottom: 10px;">
                        <input type="text" id="config-app-logo" value="üöó" placeholder="Emoji ou texto" style="flex: 1;">
                        <span>ou</span>
                        <input type="file" id="config-app-image" accept="image/png,image/jpeg,image/jpg" style="flex: 1;">
                    </div>
                    <div id="app-logo-preview" style="width: 60px; height: 60px; border: 2px dashed #ccc; border-radius: 10px; display: flex; align-items: center; justify-content: center; margin-bottom: 10px; background: #f8fafc;">
                        <span style="font-size: 2rem;">üöó</span>
                    </div>
                    <button type="button" class="btn btn-secondary" onclick="limparLogoApp()" style="padding: 5px 10px; font-size: 0.9rem;">üóëÔ∏è Limpar</button>
                </div>
                <div class="form-group">
                    <label>Logo do Desenvolvedor</label>
                    <div style="display: flex; gap: 10px; align-items: center; margin-bottom: 10px;">
                        <input type="text" id="config-dev-logo" value="JLB" placeholder="Emoji ou texto" style="flex: 1;">
                        <span>ou</span>
                        <input type="file" id="config-dev-image" accept="image/png,image/jpeg,image/jpg" style="flex: 1;">
                    </div>
                    <div id="dev-logo-preview" style="width: 50px; height: 50px; border: 2px dashed #ccc; border-radius: 10px; display: flex; align-items: center; justify-content: center; margin-bottom: 10px; background: #f8fafc;">
                        <span style="font-size: 1.5rem;">JLB</span>
                    </div>
                    <button type="button" class="btn btn-secondary" onclick="limparLogoDev()" style="padding: 5px 10px; font-size: 0.9rem;">üóëÔ∏è Limpar</button>
                </div>
                <button type="submit" class="btn">üíæ Salvar Configura√ß√µes</button>
            </form>
        </div>

        <!-- Admin Apoiadores -->
        <div id="admin-apoiadores" class="tab-content">
            <h2>ü§ù Gerenciar Apoiadores</h2>
            
            <button class="btn" onclick="showNovoApoiador()" style="margin-bottom: 20px;">‚ûï Novo Apoiador</button>
            
            <div id="novo-apoiador-form" class="hidden" style="background: #f8fafc; padding: 20px; border-radius: 10px; margin-bottom: 20px;">
                <h3>Adicionar Apoiador/Parceiro</h3>
                <form id="admin-apoiador-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label>Nome/Empresa</label>
                            <input type="text" id="apoiador-nome" required>
                        </div>
                        <div class="form-group">
                            <label>Tipo</label>
                            <select id="apoiador-tipo" required>
                                <option value="Patrocinador Principal">Patrocinador Principal</option>
                                <option value="Parceiro Comercial">Parceiro Comercial</option>
                                <option value="Apoiador">Apoiador</option>
                                <option value="Institui√ß√£o">Institui√ß√£o</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Logo do Apoiador</label>
                        <div style="display: flex; gap: 10px; align-items: center; margin-bottom: 10px;">
                            <input type="text" id="apoiador-logo" placeholder="üè¢" style="flex: 1;">
                            <span>ou</span>
                            <input type="file" id="apoiador-image" accept="image/png,image/jpeg,image/jpg" style="flex: 1;">
                        </div>
                        <div id="apoiador-logo-preview" style="width: 80px; height: 80px; border: 2px dashed #ccc; border-radius: 10px; display: flex; align-items: center; justify-content: center; margin-bottom: 10px; background: #f8fafc;">
                            <span style="font-size: 2rem;">üè¢</span>
                        </div>
                        <button type="button" class="btn btn-secondary" onclick="limparLogoApoiador()" style="padding: 5px 10px; font-size: 0.9rem;">üóëÔ∏è Limpar</button>
                    </div>
                    <div class="form-group">
                        <label>Descri√ß√£o</label>
                        <textarea id="apoiador-descricao" rows="3" required></textarea>
                    </div>
                    <button type="submit" class="btn">üíæ Salvar Apoiador</button>
                    <button type="button" class="btn btn-secondary" onclick="cancelarNovoApoiador()">‚ùå Cancelar</button>
                </form>
            </div>

            <div class="apoiadores-grid" id="admin-apoiadores-list"></div>
        </div>

        <!-- Admin Backup & Logs -->
        <div id="admin-backup" class="tab-content">
            <h2>üíæ Backup e Logs do Sistema</h2>
            
            <div class="dashboard-grid" style="margin-bottom: 30px;">
                <div class="card">
                    <div class="card-icon">üìä</div>
                    <div class="card-title">Total de Usu√°rios</div>
                    <div class="card-value" id="total-usuarios">0</div>
                </div>
                <div class="card">
                    <div class="card-icon">üí∞</div>
                    <div class="card-title">Total de Receitas</div>
                    <div class="card-value" id="total-receitas">0</div>
                </div>
                <div class="card">
                    <div class="card-icon">üí∏</div>
                    <div class="card-title">Total de Despesas</div>
                    <div class="card-value" id="total-despesas">0</div>
                </div>
                <div class="card">
                    <div class="card-icon">üìù</div>
                    <div class="card-title">Logs Registrados</div>
                    <div class="card-value" id="total-logs">0</div>
                </div>
            </div>

            <div class="form-row" style="margin-bottom: 30px;">
                <div class="form-group">
                    <button class="btn" onclick="exportarBackup()" style="width: 100%;">üì• Exportar Backup Completo</button>
                </div>
                <div class="form-group">
                    <button class="btn btn-secondary" onclick="limparLogsAntigos()" style="width: 100%;">üßπ Limpar Logs Antigos</button>
                </div>
            </div>

            <h3>üìã Logs Recentes do Sistema</h3>
            <div style="max-height: 400px; overflow-y: auto; background: #f8fafc; border-radius: 10px; padding: 15px;">
                <div id="logs-container">
                    <p style="text-align: center; color: #6b7280;">Carregando logs...</p>
                </div>
            </div>
        </div>

        <!-- Admin Sobre -->
        <div id="admin-sobre" class="tab-content">
            <h2>üìù Editar Informa√ß√µes</h2>
            
            <form id="admin-sobre-form">
                <div class="form-group">
                    <label>Sobre o Projeto</label>
                    <textarea id="sobre-projeto" rows="4">O Volante Financeiro √© um aplicativo desenvolvido especialmente para motoristas de aplicativo e profissionais do transporte em Corumb√°-MS e Lad√°rio-MS. O sistema permite organizar despesas pessoais e operacionais, planejar ganhos, monitorar custos e otimizar a rentabilidade, adaptando-se √† realidade local da regi√£o.</textarea>
                </div>
                
                <div class="form-group">
                    <label>Nome da Escola/Institui√ß√£o</label>
                    <input type="text" id="sobre-escola" value="IFMS - Campus Corumb√°">
                </div>
                
                <div class="form-group">
                    <label>Equipe de Desenvolvimento (um por linha)</label>
                    <textarea id="sobre-equipe" rows="5">Jo√£o Victor Ribeiro de Souza
Odilon Chalis
Thaviny Maria Moraes de Toledo Soares
Wallace Kau√£ Samosa Coronel</textarea>
                </div>
                
                <div class="form-group">
                    <label>Professores Respons√°veis (um por linha)</label>
                    <textarea id="sobre-professores" rows="3">Gabriela Luiza da Costa Neves
Wellington Cesar de Oliveira</textarea>
                </div>
                
                <div class="form-group">
                    <label>Vers√£o do Sistema</label>
                    <input type="text" id="sobre-versao" value="1.0">
                </div>
                
                <button type="submit" class="btn">üíæ Salvar Altera√ß√µes</button>
            </form>
        </div>

        <!-- Footer Admin -->
        <div class="footer">
            <p>Desenvolvido por <a href="#" onclick="alert('Escola Estadual Dr. Jo√£o Leite de Barros\\nCorumb√° - MS\\n\\nSistema desenvolvido pelos alunos do curso t√©cnico.')">Escola Estadual Dr. Jo√£o Leite de Barros</a></p>
        </div>
    </div>

    <script>
        // Dados do aplicativo
        let receitas = JSON.parse(localStorage.getItem('receitas')) || [];
        let despesas = JSON.parse(localStorage.getItem('despesas')) || [];
        let metas = JSON.parse(localStorage.getItem('metas')) || { lucroMensal: 0, limiteDiario: 0 };
        let usuarios = JSON.parse(localStorage.getItem('usuarios')) || [];
        let apoiadores = JSON.parse(localStorage.getItem('apoiadores')) || [];
        let administradores = JSON.parse(localStorage.getItem('administradores')) || [];
        let currentUser = null;
        let isAdmin = false;

        // Fun√ß√£o para mostrar avisos
        function mostrarAviso(mensagem, tipo = 'success') {
            // Criar elemento do aviso
            const aviso = document.createElement('div');
            aviso.className = `alert alert-${tipo}`;
            aviso.style.position = 'fixed';
            aviso.style.top = '20px';
            aviso.style.right = '20px';
            aviso.style.zIndex = '9999';
            aviso.style.minWidth = '300px';
            aviso.style.animation = 'slideIn 0.3s ease-out';
            aviso.innerHTML = mensagem;
            
            // Adicionar ao body
            document.body.appendChild(aviso);
            
            // Remover ap√≥s 3 segundos
            setTimeout(() => {
                aviso.style.animation = 'slideOut 0.3s ease-in';
                setTimeout(() => {
                    if (aviso.parentNode) {
                        aviso.parentNode.removeChild(aviso);
                    }
                }, 300);
            }, 3000);
        }

        // Inicializar administrador padr√£o se n√£o existir
        if (administradores.length === 0) {
            administradores = [{
                id: 1,
                nome: 'Desenvolvedor Principal',
                login: 'Desenvolvedor',
                email: 'dev@volantefinanceiro.com',
                senha: 'jlb@1964',
                nivel: 'super',
                ativo: true,
                dataCriacao: new Date().toISOString()
            }];
            localStorage.setItem('administradores', JSON.stringify(administradores));
        }

        // Inicializa√ß√£o
        document.addEventListener('DOMContentLoaded', function() {
            // Definir data atual nos campos de data
            const hoje = new Date().toISOString().split('T')[0];
            const receitaData = document.getElementById('receita-data');
            const despesaData = document.getElementById('despesa-data');
            if (receitaData) receitaData.value = hoje;
            if (despesaData) despesaData.value = hoje;

            // Aplicar m√°scaras
            aplicarMascaras();
            
            // Configurar verifica√ß√£o de CPF
            configurarVerificacaoCPF();
            
            // Configurar formul√°rios
            configurarFormularios();
            
            // Configurar uploads de imagem
            configurarUploads();
        });

        // Configurar verifica√ß√£o de CPF em tempo real
        function configurarVerificacaoCPF() {
            const cpfInput = document.getElementById('login-cpf');
            const cpfStatus = document.getElementById('cpf-status');
            
            if (cpfInput && cpfStatus) {
                cpfInput.addEventListener('input', function() {
                    const cpf = this.value;
                    
                    if (cpf.length >= 14) { // CPF completo com m√°scara
                        if (validarCPF(cpf)) {
                            const usuario = usuarios.find(u => u.cpf === cpf);
                            if (usuario) {
                                cpfStatus.innerHTML = '‚úÖ CPF encontrado! Digite sua senha.';
                                cpfStatus.style.color = '#16a34a';
                            } else {
                                cpfStatus.innerHTML = '‚ùå CPF n√£o cadastrado. <a href="#" onclick="showCadastro()" style="color: #2563eb; text-decoration: underline;">Criar conta</a>';
                                cpfStatus.style.color = '#e53e3e';
                            }
                        } else {
                            cpfStatus.innerHTML = '‚ùå CPF inv√°lido!';
                            cpfStatus.style.color = '#e53e3e';
                        }
                    } else {
                        cpfStatus.innerHTML = '';
                    }
                });
            }
        }

        // Aplicar m√°scaras nos campos
        function aplicarMascaras() {
            // M√°scara CPF
            document.querySelectorAll('input[id*="cpf"]').forEach(input => {
                input.addEventListener('input', function(e) {
                    let value = e.target.value.replace(/\D/g, '');
                    value = value.replace(/(\d{3})(\d)/, '$1.$2');
                    value = value.replace(/(\d{3})(\d)/, '$1.$2');
                    value = value.replace(/(\d{3})(\d{1,2})$/, '$1-$2');
                    e.target.value = value;
                });
            });

            // M√°scara WhatsApp
            document.querySelectorAll('input[id*="whatsapp"]').forEach(input => {
                input.addEventListener('input', function(e) {
                    let value = e.target.value.replace(/\D/g, '');
                    value = value.replace(/(\d{2})(\d)/, '($1) $2');
                    value = value.replace(/(\d{5})(\d)/, '$1-$2');
                    e.target.value = value;
                });
            });
        }

        // Configurar formul√°rios
        function configurarFormularios() {
            // Login
            document.getElementById('login-form').addEventListener('submit', function(e) {
                e.preventDefault();
                fazerLogin();
            });

            // Login Admin
            const adminLoginForm = document.getElementById('admin-login-form');
            if (adminLoginForm) {
                adminLoginForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    fazerLoginAdmin();
                });
            }

            // Cadastro
            document.getElementById('cadastro-form').addEventListener('submit', function(e) {
                e.preventDefault();
                criarConta();
            });

            // Receitas
            const receitaForm = document.getElementById('receita-form');
            if (receitaForm) {
                receitaForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    adicionarReceita();
                });
            }

            // Despesas
            const despesaForm = document.getElementById('despesa-form');
            if (despesaForm) {
                despesaForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    adicionarDespesa();
                });
            }

            // Metas
            const metaForm = document.getElementById('meta-form');
            if (metaForm) {
                metaForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    salvarMetas();
                });
            }

            // Admin forms
            const adminUsuarioForm = document.getElementById('admin-usuario-form');
            if (adminUsuarioForm) {
                adminUsuarioForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    salvarUsuarioAdmin();
                });
            }

            const configForm = document.getElementById('config-form');
            if (configForm) {
                configForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    salvarConfiguracoes();
                });
            }

            const adminApoiadorForm = document.getElementById('admin-apoiador-form');
            if (adminApoiadorForm) {
                adminApoiadorForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    salvarApoiador();
                });
            }

            const adminSobreForm = document.getElementById('admin-sobre-form');
            if (adminSobreForm) {
                adminSobreForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    salvarSobre();
                });
            }

            const adminAdminForm = document.getElementById('admin-admin-form');
            if (adminAdminForm) {
                adminAdminForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    salvarAdministrador();
                });
            }
        }

        // Validar CPF
        function validarCPF(cpf) {
            cpf = cpf.replace(/\D/g, '');
            if (cpf.length !== 11) return false;
            
            // Verificar se todos os d√≠gitos s√£o iguais
            if (/^(\d)\1{10}$/.test(cpf)) return false;
            
            // Validar d√≠gitos verificadores
            let soma = 0;
            for (let i = 0; i < 9; i++) {
                soma += parseInt(cpf.charAt(i)) * (10 - i);
            }
            let resto = 11 - (soma % 11);
            let dv1 = resto < 2 ? 0 : resto;
            
            if (parseInt(cpf.charAt(9)) !== dv1) return false;
            
            soma = 0;
            for (let i = 0; i < 10; i++) {
                soma += parseInt(cpf.charAt(i)) * (11 - i);
            }
            resto = 11 - (soma % 11);
            let dv2 = resto < 2 ? 0 : resto;
            
            return parseInt(cpf.charAt(10)) === dv2;
        }

        // Fazer login
        function fazerLogin() {
            const cpf = document.getElementById('login-cpf').value;
            const senha = document.getElementById('login-senha').value;

            if (!cpf || !senha) {
                mostrarAviso('‚ùå Por favor, preencha CPF e senha!', 'danger');
                return;
            }

            if (!validarCPF(cpf)) {
                mostrarAviso('‚ùå CPF inv√°lido! Verifique o formato: 000.000.000-00', 'danger');
                return;
            }

            // Verificar se usu√°rio existe
            const usuarioExiste = usuarios.find(u => u.cpf === cpf);
            
            if (!usuarioExiste) {
                mostrarAviso('‚ùå CPF n√£o cadastrado! Para acessar o sistema, voc√™ precisa criar uma conta primeiro. Clique em "Criar Conta" para se cadastrar.', 'warning');
                return;
            }

            // Verificar se usu√°rio est√° ativo
            if (!usuarioExiste.ativo) {
                mostrarAviso('‚ùå Sua conta est√° inativa! Entre em contato com o administrador do sistema para reativar sua conta.', 'danger');
                return;
            }

            // Verificar senha
            if (usuarioExiste.senha !== senha) {
                mostrarAviso('‚ùå Senha incorreta! Verifique sua senha e tente novamente.', 'danger');
                return;
            }

            // Login bem-sucedido
            console.log('Login bem-sucedido:', usuarioExiste);
            currentUser = usuarioExiste;
            isAdmin = false;
            mostrarAviso('‚úÖ Login realizado com sucesso! Bem-vindo(a) ao sistema!', 'success');
            setTimeout(() => showMainApp(), 1000);
        }

        // Fazer login administrativo
        function fazerLoginAdmin() {
            const login = document.getElementById('admin-login-user').value;
            const senha = document.getElementById('admin-login-senha').value;

            if (!login || !senha) {
                mostrarAviso('‚ùå Por favor, preencha login e senha!', 'danger');
                return;
            }

            // Verificar administrador
            const admin = administradores.find(a => a.login === login && a.senha === senha && a.ativo);
            
            if (admin) {
                currentUser = admin;
                isAdmin = true;
                mostrarAviso('‚úÖ Login administrativo realizado com sucesso!', 'success');
                setTimeout(() => showAdminPanel(), 1000);
            } else {
                mostrarAviso('‚ùå Login ou senha incorretos, ou administrador inativo!', 'danger');
            }
        }

        // Criar conta
        function criarConta() {
            const nome = document.getElementById('cadastro-nome').value.trim();
            const cpf = document.getElementById('cadastro-cpf').value.trim();
            const email = document.getElementById('cadastro-email').value.trim();
            const whatsapp = document.getElementById('cadastro-whatsapp').value.trim();
            const senha = document.getElementById('cadastro-senha').value;
            const confirmaSenha = document.getElementById('cadastro-confirma-senha').value;

            console.log('Tentativa de cadastro:', { nome, cpf, email, whatsapp });

            // Valida√ß√µes b√°sicas
            if (!nome || !cpf || !email || !whatsapp || !senha || !confirmaSenha) {
                mostrarAviso('‚ùå Por favor, preencha todos os campos obrigat√≥rios!', 'warning');
                return;
            }

            if (nome.length < 3) {
                mostrarAviso('‚ùå Nome deve ter pelo menos 3 caracteres!', 'warning');
                return;
            }

            if (!validarCPF(cpf)) {
                mostrarAviso('‚ùå CPF inv√°lido! Verifique o formato: 000.000.000-00', 'danger');
                return;
            }

            // Verificar se CPF j√° existe
            if (usuarios.find(u => u.cpf === cpf)) {
                mostrarAviso('‚ùå Este CPF j√° est√° cadastrado! Se voc√™ j√° tem uma conta, use a op√ß√£o "Entrar" para fazer login.', 'warning');
                return;
            }

            // Verificar se email j√° existe
            if (usuarios.find(u => u.email === email)) {
                mostrarAviso('‚ùå Este e-mail j√° est√° cadastrado! Use um e-mail diferente ou fa√ßa login se j√° tem uma conta.', 'warning');
                return;
            }

            // Validar email
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(email)) {
                mostrarAviso('‚ùå E-mail inv√°lido! Digite um e-mail v√°lido.', 'danger');
                return;
            }

            // Validar WhatsApp
            const whatsappLimpo = whatsapp.replace(/\D/g, '');
            if (whatsappLimpo.length < 10 || whatsappLimpo.length > 11) {
                mostrarAviso('‚ùå WhatsApp inv√°lido! Digite um n√∫mero v√°lido com DDD.', 'danger');
                return;
            }

            if (senha !== confirmaSenha) {
                mostrarAviso('‚ùå As senhas n√£o conferem! Digite a mesma senha nos dois campos.', 'danger');
                return;
            }

            if (senha.length < 6) {
                mostrarAviso('‚ùå A senha deve ter pelo menos 6 caracteres!', 'danger');
                return;
            }

            // Criar usu√°rio
            const novoUsuario = {
                id: Date.now(),
                nome: nome,
                cpf: cpf,
                email: email,
                whatsapp: whatsapp,
                senha: senha,
                ativo: true,
                dataCadastro: new Date().toISOString()
            };

            try {
                usuarios.push(novoUsuario);
                localStorage.setItem('usuarios', JSON.stringify(usuarios));
                
                console.log('‚úÖ Usu√°rio criado com sucesso:', novoUsuario);
                console.log('Total de usu√°rios cadastrados:', usuarios.length);

                mostrarAviso(`üéâ Conta criada com sucesso! Nome: ${nome} | CPF: ${cpf} | E-mail: ${email} | WhatsApp: ${whatsapp}. Agora voc√™ pode fazer login!`, 'success');
                
                // Limpar formul√°rio
                document.getElementById('cadastro-form').reset();
                
                // Voltar para tela de login ap√≥s 3 segundos
                setTimeout(() => {
                    showLogin();
                    // Preencher CPF automaticamente
                    document.getElementById('login-cpf').value = cpf;
                }, 3000);
                
            } catch (error) {
                console.error('Erro ao salvar usu√°rio:', error);
                mostrarAviso('‚ùå Erro ao criar conta! Tente novamente.', 'danger');
            }
        }

        // Mostrar telas
        function showLogin() {
            document.getElementById('login-screen').classList.remove('hidden');
            document.getElementById('admin-login-screen').classList.add('hidden');
            document.getElementById('cadastro-screen').classList.add('hidden');
            document.getElementById('main-app').classList.add('hidden');
            document.getElementById('admin-panel').classList.add('hidden');
        }

        function showAdminLogin() {
            document.getElementById('login-screen').classList.add('hidden');
            document.getElementById('admin-login-screen').classList.remove('hidden');
            document.getElementById('cadastro-screen').classList.add('hidden');
            document.getElementById('main-app').classList.add('hidden');
            document.getElementById('admin-panel').classList.add('hidden');
        }

        function showCadastro() {
            document.getElementById('login-screen').classList.add('hidden');
            document.getElementById('admin-login-screen').classList.add('hidden');
            document.getElementById('cadastro-screen').classList.remove('hidden');
            document.getElementById('main-app').classList.add('hidden');
            document.getElementById('admin-panel').classList.add('hidden');
        }

        function showMainApp() {
            document.getElementById('login-screen').classList.add('hidden');
            document.getElementById('admin-login-screen').classList.add('hidden');
            document.getElementById('cadastro-screen').classList.add('hidden');
            document.getElementById('main-app').classList.remove('hidden');
            document.getElementById('admin-panel').classList.add('hidden');
            
            if (currentUser) {
                document.getElementById('user-name').textContent = currentUser.nome;
                carregarDadosUsuario();
                atualizarDashboard();
                atualizarListas();
                verificarAlertas();
            }
        }

        function showAdminPanel() {
            document.getElementById('login-screen').classList.add('hidden');
            document.getElementById('admin-login-screen').classList.add('hidden');
            document.getElementById('cadastro-screen').classList.add('hidden');
            document.getElementById('main-app').classList.add('hidden');
            document.getElementById('admin-panel').classList.remove('hidden');
            
            carregarUsuariosAdmin();
            carregarAdministradoresAdmin();
            carregarApoiadoresAdmin();
        }

        // Logout
        function logout() {
            currentUser = null;
            isAdmin = false;
            showLogin();
        }

        // Navega√ß√£o entre abas
        function showTab(tabName) {
            // Esconder todas as abas
            const tabs = document.querySelectorAll('#main-app .tab-content');
            tabs.forEach(tab => tab.classList.remove('active'));

            // Remover classe active dos bot√µes
            const buttons = document.querySelectorAll('#main-nav .nav-tab');
            buttons.forEach(btn => btn.classList.remove('active'));

            // Mostrar aba selecionada
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');

            // Atualizar gr√°ficos se necess√°rio
            if (tabName === 'dashboard') {
                setTimeout(atualizarGraficoDashboard, 100);
            } else if (tabName === 'relatorios') {
                setTimeout(gerarRelatorio, 100);
            }
        }

        function showAdminTab(tabName) {
            // Esconder todas as abas admin
            const tabs = document.querySelectorAll('#admin-panel .tab-content');
            tabs.forEach(tab => tab.classList.remove('active'));

            // Remover classe active dos bot√µes
            const buttons = document.querySelectorAll('#admin-panel .nav-tab');
            buttons.forEach(btn => btn.classList.remove('active'));

            // Mostrar aba selecionada
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }

        // Carregar dados do usu√°rio
        function carregarDadosUsuario() {
            const userKey = `user_${currentUser.id}`;
            const userData = JSON.parse(localStorage.getItem(userKey)) || {};
            
            receitas = userData.receitas || [];
            despesas = userData.despesas || [];
            metas = userData.metas || { lucroMensal: 0, limiteDiario: 0 };
            
            carregarMetas();
        }

        // Salvar dados do usu√°rio
        function salvarDadosUsuario() {
            if (!currentUser) return;
            
            const userKey = `user_${currentUser.id}`;
            const userData = {
                receitas,
                despesas,
                metas
            };
            
            localStorage.setItem(userKey, JSON.stringify(userData));
        }

        // Adicionar receita
        function adicionarReceita() {
            const receita = {
                id: Date.now(),
                app: document.getElementById('receita-app').value,
                valor: parseFloat(document.getElementById('receita-valor').value),
                data: document.getElementById('receita-data').value,
                corridas: parseInt(document.getElementById('receita-corridas').value),
                observacoes: document.getElementById('receita-obs').value,
                tipo: 'receita'
            };

            receitas.push(receita);
            salvarDadosUsuario();
            
            document.getElementById('receita-form').reset();
            document.getElementById('receita-data').value = new Date().toISOString().split('T')[0];
            
            atualizarDashboard();
            atualizarListas();
            verificarAlertas();
        }

        // Adicionar despesa
        function adicionarDespesa() {
            const despesa = {
                id: Date.now(),
                categoria: document.getElementById('despesa-categoria').value,
                valor: parseFloat(document.getElementById('despesa-valor').value),
                data: document.getElementById('despesa-data').value,
                descricao: document.getElementById('despesa-descricao').value,
                tipo: 'despesa'
            };

            despesas.push(despesa);
            salvarDadosUsuario();
            
            document.getElementById('despesa-form').reset();
            document.getElementById('despesa-data').value = new Date().toISOString().split('T')[0];
            
            atualizarDashboard();
            atualizarListas();
            verificarAlertas();
        }

        // Salvar metas
        function salvarMetas() {
            metas.lucroMensal = parseFloat(document.getElementById('meta-valor').value);
            metas.limiteDiario = parseFloat(document.getElementById('limite-diario').value);
            
            salvarDadosUsuario();
            
            atualizarDashboard();
            verificarAlertas();
            
            mostrarAviso('‚úÖ Metas salvas com sucesso!', 'success');
        }

        // Carregar metas salvas
        function carregarMetas() {
            document.getElementById('meta-valor').value = metas.lucroMensal || '';
            document.getElementById('limite-diario').value = metas.limiteDiario || '';
        }

        // Atualizar dashboard
        function atualizarDashboard() {
            const mesAtual = new Date().toISOString().slice(0, 7);
            
            const receitasMes = receitas
                .filter(r => r.data.startsWith(mesAtual))
                .reduce((sum, r) => sum + r.valor, 0);
            
            const despesasMes = despesas
                .filter(d => d.data.startsWith(mesAtual))
                .reduce((sum, d) => sum + d.valor, 0);
            
            const lucroMes = receitasMes - despesasMes;
            
            document.getElementById('receita-mes').textContent = `R$ ${receitasMes.toFixed(2)}`;
            document.getElementById('despesas-mes').textContent = `R$ ${despesasMes.toFixed(2)}`;
            document.getElementById('lucro-mes').textContent = `R$ ${lucroMes.toFixed(2)}`;
            document.getElementById('meta-mes').textContent = `R$ ${metas.lucroMensal.toFixed(2)}`;

            // Atualizar progresso da meta
            const progresso = metas.lucroMensal > 0 ? (lucroMes / metas.lucroMensal) * 100 : 0;
            document.getElementById('progress-bar').style.width = `${Math.min(progresso, 100)}%`;
            document.getElementById('progress-text').textContent = `${progresso.toFixed(1)}% da meta atingida`;

            // Atualizar transa√ß√µes recentes
            atualizarTransacoesRecentes();
            
            // Atualizar gr√°fico
            setTimeout(atualizarGraficoDashboard, 100);
        }

        // Atualizar listas
        function atualizarListas() {
            atualizarListaReceitas();
            atualizarListaDespesas();
        }

        // Atualizar lista de receitas
        function atualizarListaReceitas() {
            const lista = document.getElementById('receitas-list');
            if (!lista) return;
            
            lista.innerHTML = '';

            receitas.sort((a, b) => new Date(b.data) - new Date(a.data)).forEach(receita => {
                const item = document.createElement('div');
                item.className = 'transaction-item';
                item.innerHTML = `
                    <div class="transaction-info">
                        <div class="transaction-description">${receita.app} - ${receita.corridas} corridas</div>
                        <div class="transaction-category">${new Date(receita.data).toLocaleDateString('pt-BR')} ${receita.observacoes ? '‚Ä¢ ' + receita.observacoes : ''}</div>
                    </div>
                    <div class="transaction-value positive">+R$ ${receita.valor.toFixed(2)}</div>
                    <button class="btn btn-danger" onclick="removerItem('receitas', ${receita.id})" style="margin-left: 10px; padding: 5px 10px;">üóëÔ∏è</button>
                `;
                lista.appendChild(item);
            });
        }

        // Atualizar lista de despesas
        function atualizarListaDespesas() {
            const lista = document.getElementById('despesas-list');
            if (!lista) return;
            
            lista.innerHTML = '';

            despesas.sort((a, b) => new Date(b.data) - new Date(a.data)).forEach(despesa => {
                const item = document.createElement('div');
                item.className = 'transaction-item expense';
                item.innerHTML = `
                    <div class="transaction-info">
                        <div class="transaction-description">${despesa.descricao}</div>
                        <div class="transaction-category">${despesa.categoria} ‚Ä¢ ${new Date(despesa.data).toLocaleDateString('pt-BR')}</div>
                    </div>
                    <div class="transaction-value negative">-R$ ${despesa.valor.toFixed(2)}</div>
                    <button class="btn btn-danger" onclick="removerItem('despesas', ${despesa.id})" style="margin-left: 10px; padding: 5px 10px;">üóëÔ∏è</button>
                `;
                lista.appendChild(item);
            });
        }

        // Atualizar transa√ß√µes recentes
        function atualizarTransacoesRecentes() {
            const lista = document.getElementById('recent-transactions');
            if (!lista) return;
            
            lista.innerHTML = '';

            const todasTransacoes = [...receitas, ...despesas]
                .sort((a, b) => new Date(b.data) - new Date(a.data))
                .slice(0, 5);

            todasTransacoes.forEach(transacao => {
                const item = document.createElement('div');
                item.className = `transaction-item ${transacao.tipo === 'despesa' ? 'expense' : ''}`;
                
                const descricao = transacao.tipo === 'receita' 
                    ? `${transacao.app} - ${transacao.corridas} corridas`
                    : transacao.descricao;
                
                const categoria = transacao.tipo === 'receita'
                    ? new Date(transacao.data).toLocaleDateString('pt-BR')
                    : `${transacao.categoria} ‚Ä¢ ${new Date(transacao.data).toLocaleDateString('pt-BR')}`;

                item.innerHTML = `
                    <div class="transaction-info">
                        <div class="transaction-description">${descricao}</div>
                        <div class="transaction-category">${categoria}</div>
                    </div>
                    <div class="transaction-value ${transacao.tipo === 'receita' ? 'positive' : 'negative'}">
                        ${transacao.tipo === 'receita' ? '+' : '-'}R$ ${transacao.valor.toFixed(2)}
                    </div>
                `;
                lista.appendChild(item);
            });
        }

        // Remover item
        function removerItem(tipo, id) {
            if (confirm('Tem certeza que deseja remover este item?')) {
                if (tipo === 'receitas') {
                    receitas = receitas.filter(r => r.id !== id);
                } else {
                    despesas = despesas.filter(d => d.id !== id);
                }
                
                salvarDadosUsuario();
                atualizarDashboard();
                atualizarListas();
                verificarAlertas();
            }
        }

        // Verificar alertas
        function verificarAlertas() {
            const alertsContainer = document.getElementById('alerts-container');
            if (!alertsContainer) return;
            
            alertsContainer.innerHTML = '';

            const hoje = new Date().toISOString().split('T')[0];
            const mesAtual = new Date().toISOString().slice(0, 7);
            
            // Verificar gastos di√°rios
            const gastosHoje = despesas
                .filter(d => d.data === hoje)
                .reduce((sum, d) => sum + d.valor, 0);

            if (metas.limiteDiario > 0 && gastosHoje > metas.limiteDiario) {
                const alert = document.createElement('div');
                alert.className = 'alert alert-warning';
                alert.innerHTML = `‚ö†Ô∏è Aten√ß√£o! Voc√™ j√° gastou R$ ${gastosHoje.toFixed(2)} hoje, ultrapassando seu limite di√°rio de R$ ${metas.limiteDiario.toFixed(2)}.`;
                alertsContainer.appendChild(alert);
            }

            // Verificar progresso da meta
            const receitasMes = receitas
                .filter(r => r.data.startsWith(mesAtual))
                .reduce((sum, r) => sum + r.valor, 0);
            
            const despesasMes = despesas
                .filter(d => d.data.startsWith(mesAtual))
                .reduce((sum, d) => sum + d.valor, 0);
            
            const lucroMes = receitasMes - despesasMes;

            if (metas.lucroMensal > 0) {
                const progresso = (lucroMes / metas.lucroMensal) * 100;
                
                if (progresso >= 100) {
                    const alert = document.createElement('div');
                    alert.className = 'alert alert-success';
                    alert.innerHTML = `üéâ Parab√©ns! Voc√™ atingiu sua meta mensal de lucro!`;
                    alertsContainer.appendChild(alert);
                } else if (progresso < 50 && new Date().getDate() > 15) {
                    const alert = document.createElement('div');
                    alert.className = 'alert alert-warning';
                    alert.innerHTML = `üìä Voc√™ est√° com ${progresso.toFixed(1)}% da sua meta mensal. Considere aumentar o ritmo de trabalho.`;
                    alertsContainer.appendChild(alert);
                }
            }
        }

        // Gr√°fico do dashboard
        let dashboardChart;
        function atualizarGraficoDashboard() {
            const ctx = document.getElementById('dashboardChart');
            if (!ctx) return;
            
            if (dashboardChart) {
                dashboardChart.destroy();
            }

            const ultimosMeses = [];
            const receitasData = [];
            const despesasData = [];
            
            for (let i = 5; i >= 0; i--) {
                const data = new Date();
                data.setMonth(data.getMonth() - i);
                const mesAno = data.toISOString().slice(0, 7);
                
                ultimosMeses.push(data.toLocaleDateString('pt-BR', { month: 'short', year: '2-digit' }));
                
                const receitaMes = receitas
                    .filter(r => r.data.startsWith(mesAno))
                    .reduce((sum, r) => sum + r.valor, 0);
                
                const despesaMes = despesas
                    .filter(d => d.data.startsWith(mesAno))
                    .reduce((sum, d) => sum + d.valor, 0);
                
                receitasData.push(receitaMes);
                despesasData.push(despesaMes);
            }

            dashboardChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ultimosMeses,
                    datasets: [{
                        label: 'Receitas',
                        data: receitasData,
                        borderColor: '#16a34a',
                        backgroundColor: 'rgba(22, 163, 74, 0.1)',
                        tension: 0.4
                    }, {
                        label: 'Despesas',
                        data: despesasData,
                        borderColor: '#e53e3e',
                        backgroundColor: 'rgba(229, 62, 62, 0.1)',
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Evolu√ß√£o Financeira - √öltimos 6 Meses'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return 'R$ ' + value.toFixed(0);
                                }
                            }
                        }
                    }
                }
            });
        }

        // Gerar relat√≥rio
        let reportChart;
        function gerarRelatorio() {
            const periodo = document.getElementById('periodo-relatorio').value;
            const ctx = document.getElementById('reportChart');
            if (!ctx) return;
            
            if (reportChart) {
                reportChart.destroy();
            }

            let dadosRelatorio = [];
            let labels = [];
            
            const hoje = new Date();
            
            if (periodo === 'mes') {
                // √öltimos 30 dias
                for (let i = 29; i >= 0; i--) {
                    const data = new Date(hoje);
                    data.setDate(data.getDate() - i);
                    const dataStr = data.toISOString().split('T')[0];
                    
                    labels.push(data.getDate().toString());
                    
                    const receitaDia = receitas
                        .filter(r => r.data === dataStr)
                        .reduce((sum, r) => sum + r.valor, 0);
                    
                    const despesaDia = despesas
                        .filter(d => d.data === dataStr)
                        .reduce((sum, d) => sum + d.valor, 0);
                    
                    dadosRelatorio.push(receitaDia - despesaDia);
                }
            } else {
                // Por m√™s
                const meses = periodo === 'trimestre' ? 3 : periodo === 'semestre' ? 6 : 12;
                
                for (let i = meses - 1; i >= 0; i--) {
                    const data = new Date(hoje);
                    data.setMonth(data.getMonth() - i);
                    const mesAno = data.toISOString().slice(0, 7);
                    
                    labels.push(data.toLocaleDateString('pt-BR', { month: 'short', year: '2-digit' }));
                    
                    const receitaMes = receitas
                        .filter(r => r.data.startsWith(mesAno))
                        .reduce((sum, r) => sum + r.valor, 0);
                    
                    const despesaMes = despesas
                        .filter(d => d.data.startsWith(mesAno))
                        .reduce((sum, d) => sum + d.valor, 0);
                    
                    dadosRelatorio.push(receitaMes - despesaMes);
                }
            }

            reportChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Lucro L√≠quido',
                        data: dadosRelatorio,
                        backgroundColor: dadosRelatorio.map(valor => 
                            valor >= 0 ? 'rgba(22, 163, 74, 0.8)' : 'rgba(229, 62, 62, 0.8)'
                        ),
                        borderColor: dadosRelatorio.map(valor => 
                            valor >= 0 ? '#16a34a' : '#e53e3e'
                        ),
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: `Relat√≥rio de Lucro - ${periodo.charAt(0).toUpperCase() + periodo.slice(1)}`
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return 'R$ ' + value.toFixed(0);
                                }
                            }
                        }
                    }
                }
            });

            // Gerar resumo
            const totalLucro = dadosRelatorio.reduce((sum, valor) => sum + valor, 0);
            const mediaLucro = totalLucro / dadosRelatorio.length;
            const melhorPeriodo = Math.max(...dadosRelatorio);
            const piorPeriodo = Math.min(...dadosRelatorio);

            const resumo = document.getElementById('relatorio-resumo');
            if (resumo) {
                resumo.innerHTML = `
                    <div class="dashboard-grid">
                        <div class="card">
                            <div class="card-icon">üí∞</div>
                            <div class="card-title">Lucro Total</div>
                            <div class="card-value">R$ ${totalLucro.toFixed(2)}</div>
                        </div>
                        <div class="card">
                            <div class="card-icon">üìä</div>
                            <div class="card-title">M√©dia ${periodo === 'mes' ? 'Di√°ria' : 'Mensal'}</div>
                            <div class="card-value">R$ ${mediaLucro.toFixed(2)}</div>
                        </div>
                        <div class="card">
                            <div class="card-icon">üìà</div>
                            <div class="card-title">Melhor Resultado</div>
                            <div class="card-value">R$ ${melhorPeriodo.toFixed(2)}</div>
                        </div>
                        <div class="card">
                            <div class="card-icon">üìâ</div>
                            <div class="card-title">Pior Resultado</div>
                            <div class="card-value">R$ ${piorPeriodo.toFixed(2)}</div>
                        </div>
                    </div>
                `;
            }
        }

        // Fun√ß√µes Admin
        function showNovoAdmin() {
            document.getElementById('novo-admin-form').classList.remove('hidden');
        }

        function cancelarNovoAdmin() {
            document.getElementById('novo-admin-form').classList.add('hidden');
            document.getElementById('admin-admin-form').reset();
        }

        function gerarSenhaAdmin() {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%&*';
            let senha = '';
            for (let i = 0; i < 10; i++) {
                senha += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            document.getElementById('admin-admin-senha').value = senha;
        }

        function salvarAdministrador() {
            const nome = document.getElementById('admin-admin-nome').value;
            const login = document.getElementById('admin-admin-login').value;
            const email = document.getElementById('admin-admin-email').value;
            const nivel = document.getElementById('admin-admin-nivel').value;
            const senha = document.getElementById('admin-admin-senha').value;

            if (administradores.find(a => a.login === login)) {
                alert('‚ùå Login j√° existe!');
                return;
            }

            if (senha.length < 6) {
                alert('‚ùå Senha deve ter pelo menos 6 caracteres!');
                return;
            }

            const novoAdmin = {
                id: Date.now(),
                nome,
                login,
                email,
                senha,
                nivel,
                ativo: true,
                dataCriacao: new Date().toISOString()
            };

            administradores.push(novoAdmin);
            localStorage.setItem('administradores', JSON.stringify(administradores));

            alert(`‚úÖ Administrador criado com sucesso!\n\nLogin: ${login}\nSenha: ${senha}\n\nCopie estas informa√ß√µes para o novo administrador.`);
            
            cancelarNovoAdmin();
            carregarAdministradoresAdmin();
        }

        function carregarAdministradoresAdmin() {
            const tbody = document.getElementById('admins-table');
            if (!tbody) return;
            
            tbody.innerHTML = '';

            administradores.forEach(admin => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${admin.nome}</td>
                    <td>${admin.login}</td>
                    <td>${admin.email}</td>
                    <td>${admin.nivel === 'super' ? 'üëë Super Admin' : 'üë®‚Äçüíº Admin'}</td>
                    <td>${admin.ativo ? '‚úÖ Ativo' : '‚ùå Inativo'}</td>
                    <td>
                        <button class="btn btn-secondary" onclick="toggleAdmin(${admin.id})" style="margin-right: 5px; padding: 5px 10px;">
                            ${admin.ativo ? '‚è∏Ô∏è' : '‚ñ∂Ô∏è'}
                        </button>
                        <button class="btn" onclick="gerarNovaSenhaAdmin(${admin.id})" style="margin-right: 5px; padding: 5px 10px;">üîë</button>
                        ${admin.id !== 1 ? `<button class="btn btn-danger" onclick="excluirAdmin(${admin.id})" style="padding: 5px 10px;">üóëÔ∏è</button>` : ''}
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        function toggleAdmin(id) {
            if (id === 1) {
                alert('‚ùå N√£o √© poss√≠vel desativar o administrador principal!');
                return;
            }
            
            const admin = administradores.find(a => a.id === id);
            if (admin) {
                admin.ativo = !admin.ativo;
                localStorage.setItem('administradores', JSON.stringify(administradores));
                carregarAdministradoresAdmin();
            }
        }

        function gerarNovaSenhaAdmin(id) {
            const admin = administradores.find(a => a.id === id);
            if (admin) {
                const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%&*';
                let novaSenha = '';
                for (let i = 0; i < 10; i++) {
                    novaSenha += chars.charAt(Math.floor(Math.random() * chars.length));
                }
                
                admin.senha = novaSenha;
                localStorage.setItem('administradores', JSON.stringify(administradores));
                
                alert(`‚úÖ Nova senha gerada para ${admin.nome}:\n\n${novaSenha}\n\nCopie esta senha para enviar ao administrador.`);
            }
        }

        function excluirAdmin(id) {
            if (id === 1) {
                alert('‚ùå N√£o √© poss√≠vel excluir o administrador principal!');
                return;
            }
            
            if (confirm('Tem certeza que deseja excluir este administrador? Esta a√ß√£o n√£o pode ser desfeita.')) {
                administradores = administradores.filter(a => a.id !== id);
                localStorage.setItem('administradores', JSON.stringify(administradores));
                carregarAdministradoresAdmin();
            }
        }

        function showNovoUsuario() {
            document.getElementById('novo-usuario-form').classList.remove('hidden');
        }

        function cancelarNovoUsuario() {
            document.getElementById('novo-usuario-form').classList.add('hidden');
            document.getElementById('admin-usuario-form').reset();
        }

        function gerarSenha() {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
            let senha = '';
            for (let i = 0; i < 8; i++) {
                senha += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            document.getElementById('admin-senha').value = senha;
        }

        function salvarUsuarioAdmin() {
            const nome = document.getElementById('admin-nome').value;
            const cpf = document.getElementById('admin-cpf').value;
            const email = document.getElementById('admin-email').value;
            const whatsapp = document.getElementById('admin-whatsapp').value;
            const senha = document.getElementById('admin-senha').value;

            if (!validarCPF(cpf)) {
                alert('‚ùå CPF inv√°lido!');
                return;
            }

            if (usuarios.find(u => u.cpf === cpf)) {
                alert('‚ùå CPF j√° cadastrado!');
                return;
            }

            const novoUsuario = {
                id: Date.now(),
                nome,
                cpf,
                email,
                whatsapp,
                senha,
                ativo: true,
                dataCadastro: new Date().toISOString()
            };

            usuarios.push(novoUsuario);
            localStorage.setItem('usuarios', JSON.stringify(usuarios));

            mostrarAviso(`‚úÖ Usu√°rio criado com sucesso! Senha: ${senha} - Copie esta senha para enviar ao usu√°rio.`, 'success');
            
            cancelarNovoUsuario();
            carregarUsuariosAdmin();
        }

        function carregarUsuariosAdmin() {
            const tbody = document.getElementById('usuarios-table');
            if (!tbody) return;
            
            tbody.innerHTML = '';

            usuarios.forEach(usuario => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${usuario.nome}</td>
                    <td>${usuario.cpf}</td>
                    <td>${usuario.email}</td>
                    <td>${usuario.whatsapp}</td>
                    <td>${usuario.ativo ? '‚úÖ Ativo' : '‚ùå Inativo'}</td>
                    <td>
                        <button class="btn btn-secondary" onclick="toggleUsuario(${usuario.id})" style="margin-right: 5px; padding: 5px 10px;">
                            ${usuario.ativo ? '‚è∏Ô∏è' : '‚ñ∂Ô∏è'}
                        </button>
                        <button class="btn" onclick="gerarNovaSenha(${usuario.id})" style="margin-right: 5px; padding: 5px 10px;">üîë</button>
                        <button class="btn btn-danger" onclick="excluirUsuario(${usuario.id})" style="padding: 5px 10px;">üóëÔ∏è</button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        function toggleUsuario(id) {
            const usuario = usuarios.find(u => u.id === id);
            if (usuario) {
                usuario.ativo = !usuario.ativo;
                localStorage.setItem('usuarios', JSON.stringify(usuarios));
                carregarUsuariosAdmin();
            }
        }

        function gerarNovaSenha(id) {
            const usuario = usuarios.find(u => u.id === id);
            if (usuario) {
                const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
                let novaSenha = '';
                for (let i = 0; i < 8; i++) {
                    novaSenha += chars.charAt(Math.floor(Math.random() * chars.length));
                }
                
                usuario.senha = novaSenha;
                localStorage.setItem('usuarios', JSON.stringify(usuarios));
                
                alert(`‚úÖ Nova senha gerada para ${usuario.nome}:\n\n${novaSenha}\n\nCopie esta senha para enviar ao usu√°rio via WhatsApp: ${usuario.whatsapp}`);
            }
        }

        function excluirUsuario(id) {
            if (confirm('Tem certeza que deseja excluir este usu√°rio? Esta a√ß√£o n√£o pode ser desfeita.')) {
                usuarios = usuarios.filter(u => u.id !== id);
                localStorage.setItem('usuarios', JSON.stringify(usuarios));
                carregarUsuariosAdmin();
            }
        }

        function salvarConfiguracoes() {
            const appLogo = document.getElementById('config-app-logo').value;
            const devLogo = document.getElementById('config-dev-logo').value;
            
            // Verificar se h√° imagens carregadas
            const appPreview = document.getElementById('app-logo-preview');
            const devPreview = document.getElementById('dev-logo-preview');
            const appImg = appPreview.querySelector('img');
            const devImg = devPreview.querySelector('img');
            
            const appLogoFinal = appImg ? appImg.src : appLogo;
            const devLogoFinal = devImg ? devImg.src : devLogo;
            
            // Atualizar logos na interface
            document.querySelectorAll('.app-logo').forEach(el => {
                if (appImg) {
                    el.innerHTML = `<img src="${appLogoFinal}" style="width: 100%; height: 100%; object-fit: cover; border-radius: 8px;">`;
                } else {
                    el.innerHTML = `<div class="volante-logo"><div class="dollar-center">$</div></div>`;
                }
            });
            
            document.querySelectorAll('.dev-logo').forEach(el => {
                if (devImg) {
                    el.innerHTML = `<img src="${devLogoFinal}" style="width: 100%; height: 100%; object-fit: cover; border-radius: 8px;">`;
                } else {
                    el.textContent = devLogoFinal;
                }
            });
            
            // Salvar configura√ß√µes
            const config = { 
                appLogo: appLogoFinal, 
                devLogo: devLogoFinal,
                appIsImage: !!appImg,
                devIsImage: !!devImg
            };
            localStorage.setItem('config', JSON.stringify(config));
            
            mostrarAviso('‚úÖ Configura√ß√µes salvas com sucesso!', 'success');
        }

        function showNovoApoiador() {
            document.getElementById('novo-apoiador-form').classList.remove('hidden');
        }

        function cancelarNovoApoiador() {
            document.getElementById('novo-apoiador-form').classList.add('hidden');
            document.getElementById('admin-apoiador-form').reset();
        }

        function salvarApoiador() {
            const nome = document.getElementById('apoiador-nome').value;
            const tipo = document.getElementById('apoiador-tipo').value;
            const logo = document.getElementById('apoiador-logo').value;
            const descricao = document.getElementById('apoiador-descricao').value;
            
            // Verificar se h√° imagem carregada
            const preview = document.getElementById('apoiador-logo-preview');
            const img = preview.querySelector('img');
            const logoFinal = img ? img.src : logo;

            const novoApoiador = {
                id: Date.now(),
                nome,
                tipo,
                logo: logoFinal,
                descricao,
                isImage: !!img
            };

            apoiadores.push(novoApoiador);
            localStorage.setItem('apoiadores', JSON.stringify(apoiadores));

            alert('‚úÖ Apoiador adicionado com sucesso!');
            
            cancelarNovoApoiador();
            carregarApoiadoresAdmin();
        }

        function carregarApoiadoresAdmin() {
            const container = document.getElementById('admin-apoiadores-list');
            if (!container) return;
            
            container.innerHTML = '';

            apoiadores.forEach(apoiador => {
                const card = document.createElement('div');
                card.className = 'apoiador-card';
                
                const logoHtml = apoiador.isImage 
                    ? `<img src="${apoiador.logo}" style="width: 100%; height: 100%; object-fit: cover; border-radius: 8px;">`
                    : apoiador.logo;
                
                card.innerHTML = `
                    <div class="apoiador-logo">${logoHtml}</div>
                    <h3>${apoiador.nome}</h3>
                    <p><strong>${apoiador.tipo}</strong></p>
                    <p>${apoiador.descricao}</p>
                    <button class="btn btn-danger" onclick="excluirApoiador(${apoiador.id})" style="margin-top: 10px;">üóëÔ∏è Excluir</button>
                `;
                container.appendChild(card);
            });
        }

        function excluirApoiador(id) {
            if (confirm('Tem certeza que deseja excluir este apoiador?')) {
                apoiadores = apoiadores.filter(a => a.id !== id);
                localStorage.setItem('apoiadores', JSON.stringify(apoiadores));
                carregarApoiadoresAdmin();
            }
        }

        function salvarSobre() {
            const projeto = document.getElementById('sobre-projeto').value;
            const escola = document.getElementById('sobre-escola').value;
            const equipe = document.getElementById('sobre-equipe').value;
            const professores = document.getElementById('sobre-professores').value;
            const versao = document.getElementById('sobre-versao').value;
            
            const sobreInfo = { projeto, escola, equipe, professores, versao };
            localStorage.setItem('sobre', JSON.stringify(sobreInfo));
            
            alert('‚úÖ Informa√ß√µes salvas com sucesso!');
        }

        // Configurar uploads de imagem
        function configurarUploads() {
            // Upload logo do app
            const appImageInput = document.getElementById('config-app-image');
            if (appImageInput) {
                appImageInput.addEventListener('change', function(e) {
                    const file = e.target.files[0];
                    if (file) {
                        if (file.size > 2 * 1024 * 1024) { // 2MB
                            alert('‚ùå Imagem muito grande! M√°ximo 2MB.');
                            return;
                        }
                        
                        const reader = new FileReader();
                        reader.onload = function(e) {
                            const preview = document.getElementById('app-logo-preview');
                            preview.innerHTML = `<img src="${e.target.result}" style="width: 100%; height: 100%; object-fit: cover; border-radius: 8px;">`;
                            document.getElementById('config-app-logo').value = ''; // Limpar texto
                        };
                        reader.readAsDataURL(file);
                    }
                });
            }

            // Upload logo do dev
            const devImageInput = document.getElementById('config-dev-image');
            if (devImageInput) {
                devImageInput.addEventListener('change', function(e) {
                    const file = e.target.files[0];
                    if (file) {
                        if (file.size > 2 * 1024 * 1024) { // 2MB
                            alert('‚ùå Imagem muito grande! M√°ximo 2MB.');
                            return;
                        }
                        
                        const reader = new FileReader();
                        reader.onload = function(e) {
                            const preview = document.getElementById('dev-logo-preview');
                            preview.innerHTML = `<img src="${e.target.result}" style="width: 100%; height: 100%; object-fit: cover; border-radius: 8px;">`;
                            document.getElementById('config-dev-logo').value = ''; // Limpar texto
                        };
                        reader.readAsDataURL(file);
                    }
                });
            }

            // Upload logo do apoiador
            const apoiadorImageInput = document.getElementById('apoiador-image');
            if (apoiadorImageInput) {
                apoiadorImageInput.addEventListener('change', function(e) {
                    const file = e.target.files[0];
                    if (file) {
                        if (file.size > 2 * 1024 * 1024) { // 2MB
                            alert('‚ùå Imagem muito grande! M√°ximo 2MB.');
                            return;
                        }
                        
                        const reader = new FileReader();
                        reader.onload = function(e) {
                            const preview = document.getElementById('apoiador-logo-preview');
                            preview.innerHTML = `<img src="${e.target.result}" style="width: 100%; height: 100%; object-fit: cover; border-radius: 8px;">`;
                            document.getElementById('apoiador-logo').value = ''; // Limpar texto
                        };
                        reader.readAsDataURL(file);
                    }
                });
            }
        }

        // Fun√ß√µes para limpar logos
        function limparLogoApp() {
            document.getElementById('config-app-logo').value = 'üöó';
            document.getElementById('config-app-image').value = '';
            document.getElementById('app-logo-preview').innerHTML = '<span style="font-size: 2rem;">üöó</span>';
        }

        function limparLogoDev() {
            document.getElementById('config-dev-logo').value = 'JLB';
            document.getElementById('config-dev-image').value = '';
            document.getElementById('dev-logo-preview').innerHTML = '<span style="font-size: 1.5rem;">JLB</span>';
        }

        function limparLogoApoiador() {
            document.getElementById('apoiador-logo').value = 'üè¢';
            document.getElementById('apoiador-image').value = '';
            document.getElementById('apoiador-logo-preview').innerHTML = '<span style="font-size: 2rem;">üè¢</span>';
        }

        // Fun√ß√µes de Backup e Logs
        async function exportarBackup() {
            try {
                mostrarAviso('üì• Gerando backup completo...', 'success');
                
                const dados = await db.exportarDados();
                
                // Criar arquivo de download
                const dataStr = JSON.stringify(dados, null, 2);
                const dataBlob = new Blob([dataStr], { type: 'application/json' });
                
                const link = document.createElement('a');
                link.href = URL.createObjectURL(dataBlob);
                link.download = `volante-financeiro-backup-${new Date().toISOString().split('T')[0]}.json`;
                link.click();
                
                mostrarAviso('‚úÖ Backup exportado com sucesso!', 'success');
                
            } catch (error) {
                console.error('Erro ao exportar backup:', error);
                mostrarAviso('‚ùå Erro ao exportar backup.', 'danger');
            }
        }

        async function limparLogsAntigos() {
            if (!confirm('Tem certeza que deseja limpar logs com mais de 1 ano? Esta a√ß√£o n√£o pode ser desfeita.')) return;
            
            try {
                const deletedCount = await db.limparDadosAntigos(365);
                mostrarAviso(`‚úÖ ${deletedCount} logs antigos foram removidos!`, 'success');
                carregarEstatisticasBackup();
                carregarLogsRecentes();
                
            } catch (error) {
                console.error('Erro ao limpar logs:', error);
                mostrarAviso('‚ùå Erro ao limpar logs antigos.', 'danger');
            }
        }

        async function carregarEstatisticasBackup() {
            try {
                const usuarios = await db.listarUsuarios();
                const logs = await db.listarLogs(1);
                
                let totalReceitas = 0;
                let totalDespesas = 0;
                
                for (const usuario of usuarios) {
                    const receitas = await db.listarReceitasUsuario(usuario.id);
                    const despesas = await db.listarDespesasUsuario(usuario.id);
                    totalReceitas += receitas.length;
                    totalDespesas += despesas.length;
                }
                
                document.getElementById('total-usuarios').textContent = usuarios.length;
                document.getElementById('total-receitas').textContent = totalReceitas;
                document.getElementById('total-despesas').textContent = totalDespesas;
                
                // Contar logs totais (aproximado)
                const logsCompletos = await db.listarLogs(10000);
                document.getElementById('total-logs').textContent = logsCompletos.length;
                
            } catch (error) {
                console.error('Erro ao carregar estat√≠sticas:', error);
            }
        }

        async function carregarLogsRecentes() {
            try {
                const logs = await db.listarLogs(50);
                const container = document.getElementById('logs-container');
                
                if (logs.length === 0) {
                    container.innerHTML = '<p style="text-align: center; color: #6b7280;">Nenhum log encontrado.</p>';
                    return;
                }
                
                container.innerHTML = '';
                
                logs.forEach(log => {
                    const logElement = document.createElement('div');
                    logElement.style.cssText = 'padding: 10px; margin-bottom: 8px; background: white; border-radius: 8px; border-left: 4px solid #22c55e; font-size: 0.9rem;';
                    
                    const timestamp = new Date(log.timestamp).toLocaleString('pt-BR');
                    const usuario = log.userId ? ` (ID: ${log.userId})` : '';
                    
                    logElement.innerHTML = `
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <strong>${log.acao}</strong>: ${log.descricao}${usuario}
                            </div>
                            <div style="color: #6b7280; font-size: 0.8rem;">
                                ${timestamp}
                            </div>
                        </div>
                    `;
                    
                    container.appendChild(logElement);
                });
                
            } catch (error) {
                console.error('Erro ao carregar logs:', error);
                document.getElementById('logs-container').innerHTML = '<p style="text-align: center; color: #ef4444;">Erro ao carregar logs.</p>';
            }
        }

        // Atualizar fun√ß√£o showAdminPanel para carregar dados de backup
        const originalShowAdminPanel = showAdminPanel;
        showAdminPanel = function() {
            originalShowAdminPanel();
            carregarEstatisticasBackup();
            carregarLogsRecentes();
        };

        // Atualizar fun√ß√£o showAdminTab para carregar dados quando necess√°rio
        const originalShowAdminTab = showAdminTab;
        showAdminTab = function(tabName) {
            originalShowAdminTab(tabName);
            
            if (tabName === 'admin-backup') {
                carregarEstatisticasBackup();
                carregarLogsRecentes();
            }
        };
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'97549624b059f217',t:'MTc1NjIyNDQ5Mi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
